<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>自动化测试 | Hexo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="软件测试,自动化测试">
    <meta name="description" content="元素定位id定位                                                                                             image-20221026094950071                从上面定位到的元素属性中可以看到有个id属性：id&#x3D;”username”，这里可以通过id属性定位到这个元素。">
<meta property="og:type" content="article">
<meta property="og:title" content="自动化测试">
<meta property="og:url" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="元素定位id定位                                                                                             image-20221026094950071                从上面定位到的元素属性中可以看到有个id属性：id&#x3D;”username”，这里可以通过id属性定位到这个元素。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026094950071.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026095423400.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026095729734.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026095747661.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026095757202.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026095834596.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026095859089.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026095955998.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026100033560.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026100133687.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026100209167.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026100253396.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026100331104.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026100504713.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026100726333.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026104123086.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026104226339.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026104245875.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221027134238427.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026104351337.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026104458800.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026104458800.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026104728402.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026104737793.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/20210312190450849.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xJRkVORzA0MDI=,size_16,color_FFFFFF,t_70.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xJRkVORzA0MDI=,size_16,color_FFFFFF,t_70-16668556110361.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/20210312182917162.png)%EF%BC%8Cselect_by_visible_text(Audi">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026105024607.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026105057491.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026105515248.png">
<meta property="og:image" content="http://example.com/image-20221026205806485.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221027154049469.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/v2-cbc5c6037101c7d33cf0acd9f00a8cfa_r.jpg">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221027212316786.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221028102848155.png">
<meta property="og:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221028102955027.png">
<meta property="og:image" content="http://example.com/image-20221028103723325.png">
<meta property="article:published_time" content="2022-10-18T05:36:04.000Z">
<meta property="article:modified_time" content="2022-10-30T04:26:01.916Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="软件测试">
<meta property="article:tag" content="自动化测试">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20221026094950071.png">
    
        <link rel="alternate" type="application/atom+xml" title="Hexo" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 6.3.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">John Doe</h5>
          <a href="mailto:19704769@qq.com" title="19704769@qq.com" class="mail">19704769@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/yscoder" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.weibo.com/ysweb" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/custom"  >
                <i class="icon icon-lg icon-link"></i>
                测试
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">自动化测试</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">自动化测试</h1>
        <h5 class="subtitle">
            
                <time datetime="2022-10-18T05:36:04.000Z" itemprop="datePublished" class="page-time">
  2022-10-18
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/">软件测试</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/">自动化测试</a></li></ul></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E5%85%83%E7%B4%A0%E5%AE%9A%E4%BD%8D"><span class="post-toc-number">1.</span> <span class="post-toc-text">元素定位</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#id%E5%AE%9A%E4%BD%8D"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">id定位</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#name%E5%AE%9A%E4%BD%8D"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">name定位</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#xpath%E5%AE%9A%E4%BD%8D"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">xpath定位</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#css-selector%E5%AE%9A%E4%BD%8D"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">css_selector定位</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#link-text%E5%AE%9A%E4%BD%8D"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">link_text定位</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#partial-link-text%E5%AE%9A%E4%BD%8D"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">partial_link_text定位</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#class-name%E5%AE%9A%E4%BD%8D"><span class="post-toc-number">1.7.</span> <span class="post-toc-text">class_name定位</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#tag-name%E5%AE%9A%E4%BD%8D"><span class="post-toc-number">1.8.</span> <span class="post-toc-text">tag_name定位</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E5%A4%8D%E6%95%B0%E5%85%83%E7%B4%A0%E5%AE%9A%E4%BD%8D"><span class="post-toc-number">2.</span> <span class="post-toc-text">复数元素定位</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E9%BC%A0%E6%A0%87%E6%93%8D%E4%BD%9C"><span class="post-toc-number">3.</span> <span class="post-toc-text">鼠标操作</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E9%94%AE%E7%9B%98%E6%93%8D%E4%BD%9C"><span class="post-toc-number">4.</span> <span class="post-toc-text">键盘操作</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E6%97%B6%E9%97%B4%E7%AD%89%E5%BE%85%E6%96%B9%E6%B3%95"><span class="post-toc-number">5.</span> <span class="post-toc-text">时间等待方法</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%98%BE%E5%BC%8F%E7%AD%89%E5%BE%85"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">显式等待</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%BC%BA%E5%88%B6%E7%AD%89%E5%BE%85"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">强制等待</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%9A%90%E5%BC%8F%E7%AD%89%E5%BE%85"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">隐式等待</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E7%AA%97%E5%8F%A3%E5%88%87%E6%8D%A2"><span class="post-toc-number">6.</span> <span class="post-toc-text">窗口切换</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E9%A1%B5%E9%9D%A2%E5%85%83%E7%B4%A0%E5%88%A0%E9%99%A4"><span class="post-toc-number">7.</span> <span class="post-toc-text">页面元素删除</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#submit-%E6%96%B9%E6%B3%95%E4%BD%BF%E7%94%A8"><span class="post-toc-number">8.</span> <span class="post-toc-text">submit()方法使用</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E6%93%8D%E4%BD%9C%E4%B8%8B%E6%8B%89%E6%BB%9A%E5%8A%A8%E6%9D%A1"><span class="post-toc-number">9.</span> <span class="post-toc-text">操作下拉滚动条</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E4%B8%8B%E6%8B%89%E6%A1%86%E5%A4%84%E7%90%86"><span class="post-toc-number">10.</span> <span class="post-toc-text">下拉框处理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BD%BF%E7%94%A8%E9%80%89%E9%A1%B9%E5%85%83%E7%B4%A0%E6%A0%87%E7%AD%BE%E5%AE%9A%E4%BD%8D"><span class="post-toc-number">10.1.</span> <span class="post-toc-text">使用选项元素标签定位</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%9B%B4%E6%8E%A5%E9%80%9A%E8%BF%87xpath%E5%B1%82%E7%BA%A7%E6%A0%87%E7%AD%BE%E5%AE%9A%E4%BD%8D"><span class="post-toc-number">10.2.</span> <span class="post-toc-text">直接通过xpath层级标签定位</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AF%BC%E5%85%A5Select%E6%A8%A1%E5%9D%97"><span class="post-toc-number">10.3.</span> <span class="post-toc-text">导入Select模块</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#csdn%E6%9F%A5%E5%88%B0%E7%9A%84"><span class="post-toc-number">10.4.</span> <span class="post-toc-text">csdn查到的</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%B8%8B%E6%8B%89%E6%A1%86%E9%80%89%E9%A1%B9%E6%93%8D%E4%BD%9C%EF%BC%9ASelect"><span class="post-toc-number">10.4.1.</span> <span class="post-toc-text">下拉框选项操作：Select</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#options%EF%BC%9A%E8%BF%94%E5%9B%9E%E5%B1%9E%E4%BA%8E%E8%AF%A5%E9%80%89%E6%8B%A9%E6%A0%87%E7%AD%BE%E7%9A%84%E6%89%80%E6%9C%89%E9%80%89%E9%A1%B9%E5%88%97%E8%A1%A8"><span class="post-toc-number">10.4.2.</span> <span class="post-toc-text">options：返回属于该选择标签的所有选项列表</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#all-selected-options%EF%BC%9A%E8%BF%94%E5%9B%9E%E5%B1%9E%E4%BA%8E%E6%AD%A4%E9%80%89%E6%8B%A9%E6%A0%87%E7%AD%BE%E7%9A%84%E6%89%80%E6%9C%89%E9%80%89%E6%8B%A9%E7%9A%84%E9%80%89%E9%A1%B9%E5%88%97%E8%A1%A8"><span class="post-toc-number">10.4.3.</span> <span class="post-toc-text">all_selected_options：返回属于此选择标签的所有选择的选项列表</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#first-selected-option%EF%BC%9A%E8%AF%A5%E9%80%89%E6%8B%A9%E6%A0%87%E7%AD%BE%E4%B8%AD%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E9%80%89%E6%8B%A9%E7%9A%84%E9%80%89%E9%A1%B9%EF%BC%88%E6%88%96%E6%AD%A3%E5%B8%B8%E9%80%89%E6%8B%A9%E4%B8%AD%E5%BD%93%E5%89%8D%E9%80%89%E6%8B%A9%E7%9A%84%E9%80%89%E9%A1%B9%EF%BC%89"><span class="post-toc-number">10.4.4.</span> <span class="post-toc-text">first_selected_option：该选择标签中的第一个选择的选项（或正常选择中当前选择的选项）</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#select-by-value%EF%BC%9A%E9%80%89%E6%8B%A9%E6%89%80%E6%9C%89%E5%80%BC%E9%83%BD%E4%B8%8E%E5%8F%82%E6%95%B0%E5%8C%B9%E9%85%8D%E7%9A%84%E9%80%89%E9%A1%B9%E3%80%82"><span class="post-toc-number">10.4.5.</span> <span class="post-toc-text">select_by_value：选择所有值都与参数匹配的选项。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#select-by-index%EF%BC%9A%E9%80%89%E6%8B%A9%E7%BB%99%E5%AE%9A%E7%B4%A2%E5%BC%95%E5%A4%84%E7%9A%84%E9%80%89%E9%A1%B9%E3%80%82%E8%BF%99%E6%98%AF%E9%80%9A%E8%BF%87%E6%A3%80%E6%9F%A5%E5%85%83%E7%B4%A0%E7%9A%84%E2%80%9C%E7%B4%A2%E5%BC%95%E2%80%9D%E5%B1%9E%E6%80%A7%E6%9D%A5%E5%AE%8C%E6%88%90%E7%9A%84%E3%80%82"><span class="post-toc-number">10.4.6.</span> <span class="post-toc-text">select_by_index：选择给定索引处的选项。这是通过检查元素的“索引”属性来完成的。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#select-by-visible-text%EF%BC%9A%E9%80%89%E6%8B%A9%E6%89%80%E6%9C%89%E6%98%BE%E7%A4%BA%E4%B8%8E%E5%8F%82%E6%95%B0%E5%8C%B9%E9%85%8D%E7%9A%84%E6%96%87%E6%9C%AC%E7%9A%84%E9%80%89%E9%A1%B9%E3%80%82"><span class="post-toc-number">10.4.7.</span> <span class="post-toc-text">select_by_visible_text：选择所有显示与参数匹配的文本的选项。</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%A4%84%E7%90%86"><span class="post-toc-number">11.</span> <span class="post-toc-text">文件上传处理</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E9%A1%B5%E9%9D%A2%E6%88%AA%E5%9B%BE%E6%93%8D%E4%BD%9C"><span class="post-toc-number">12.</span> <span class="post-toc-text">页面截图操作</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#alert%E5%AF%B9%E8%AF%9D%E6%A1%86%E5%A4%84%E7%90%86"><span class="post-toc-number">13.</span> <span class="post-toc-text">alert对话框处理</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Unittest"><span class="post-toc-number">14.</span> <span class="post-toc-text">Unittest</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Unittest%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="post-toc-number">14.1.</span> <span class="post-toc-text">Unittest工作原理</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Unittest%E6%96%B9%E6%B3%95%E4%BD%BF%E7%94%A8"><span class="post-toc-number">14.2.</span> <span class="post-toc-text">Unittest方法使用</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Unittest%E4%B8%BB%E8%A6%81%E7%B1%BB%E5%85%B3%E7%B3%BB"><span class="post-toc-number">14.3.</span> <span class="post-toc-text">Unittest主要类关系</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Unittest%E6%A1%86%E6%9E%B6%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E"><span class="post-toc-number">14.4.</span> <span class="post-toc-text">Unittest框架使用说明</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Unittest%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E5%AE%9E%E4%BE%8B"><span class="post-toc-number">14.4.1.</span> <span class="post-toc-text">Unittest单元测试框架实例</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#CSV%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="post-toc-number">15.</span> <span class="post-toc-text">CSV文件读取</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E6%95%B0%E6%8D%AE%E9%A9%B1%E5%8A%A8"><span class="post-toc-number">16.</span> <span class="post-toc-text">数据驱动</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%80%BB%E7%BB%93"><span class="post-toc-number">16.0.1.</span> <span class="post-toc-text">总结</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#python%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B9%8B-ddt%EF%BC%8C-data%EF%BC%8C-unpack"><span class="post-toc-number">16.0.1.1.</span> <span class="post-toc-text">python数据处理之 ddt，@data， @unpack</span></a></li></ol></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E6%95%B0%E6%8D%AE%E6%96%AD%E8%A8%80"><span class="post-toc-number">17.</span> <span class="post-toc-text">数据断言</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#discover%E6%96%B9%E6%B3%95"><span class="post-toc-number">18.</span> <span class="post-toc-text">discover方法</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#PageObject%E6%A8%A1%E5%BC%8F"><span class="post-toc-number">19.</span> <span class="post-toc-text">PageObject模式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#PO%E7%AE%80%E4%BB%8B"><span class="post-toc-number">19.1.</span> <span class="post-toc-text">PO简介</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#PO%E5%8E%9F%E7%90%86"><span class="post-toc-number">19.2.</span> <span class="post-toc-text">PO原理</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#PO%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="post-toc-number">19.3.</span> <span class="post-toc-text">PO模式的作用</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E6%9C%80%E5%90%8E%E9%A2%98%E7%9B%AE"><span class="post-toc-number">20.</span> <span class="post-toc-text">最后题目</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#driver-py"><span class="post-toc-number">20.1.</span> <span class="post-toc-text">driver.py</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#function-py"><span class="post-toc-number">20.2.</span> <span class="post-toc-text">function.py</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#myunit-py"><span class="post-toc-number">20.3.</span> <span class="post-toc-text">myunit.py</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#AddPage-py"><span class="post-toc-number">20.4.</span> <span class="post-toc-text">AddPage.py</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#BasePage-py"><span class="post-toc-number">20.5.</span> <span class="post-toc-text">BasePage.py</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#LoginPage-py"><span class="post-toc-number">20.6.</span> <span class="post-toc-text">LoginPage.py</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#test-add-py"><span class="post-toc-number">20.7.</span> <span class="post-toc-text">test_add.py</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ccs-csv"><span class="post-toc-number">20.8.</span> <span class="post-toc-text">ccs.csv</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#runtest-py"><span class="post-toc-number">20.9.</span> <span class="post-toc-text">runtest.py</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%87%AA%E5%B7%B1%E8%B7%9F%E7%9D%80%E6%95%B2%E7%9A%84"><span class="post-toc-number">20.10.</span> <span class="post-toc-text">自己跟着敲的</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-软件测试/自动化测试"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">自动化测试</h1>
        <div class="post-meta">
            <time class="post-time" title="2022-10-18 13:36:04" datetime="2022-10-18T05:36:04.000Z"  itemprop="datePublished">2022-10-18</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/">软件测试</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/">自动化测试</a></li></ul></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="元素定位"><a href="#元素定位" class="headerlink" title="元素定位"></a>元素定位</h1><h2 id="id定位"><a href="#id定位" class="headerlink" title="id定位"></a>id定位</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026094950071.png" alt="image-20221026094950071" title="">
                </div>
                <div class="image-caption">image-20221026094950071</div>
            </figure>

<blockquote>
<p>从上面定位到的元素属性中可以看到有个id属性：id&#x3D;”username”，这里可以通过id属性定位到这个元素。定位到用户名输入框后，需要对其赋值，这里用send_keys( )方法进行文本输入。<br>如果需要对其单击操作，可以使用click( )方法。格式：find_element_by_id(“”)</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot; hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#通过id()方法定位页面元素，输入用户名</span></span><br></pre></td></tr></table></figure>

<h2 id="name定位"><a href="#name定位" class="headerlink" title="name定位"></a>name定位</h2><blockquote>
<p>在编写自动化脚本的时候，如果页面中某个元素没有id属性，那就没有办法通过id属性定位页面元素，但是如果页面中存在唯一的name属性，那么就可以使用name元素来定位。<br>以人力资源综合服务系统登录页面的用户名输入框为例，先打开人力资源系统登录页面，选择用户名输入框，右击查看元素，如图所示。</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026095423400.png" alt="image-20221026095423400" title="">
                </div>
                <div class="image-caption">image-20221026095423400</div>
            </figure>

<blockquote>
<p>从定位到的元素属性可以看到有个name属性：name&#x3D;”username”，这里可以通过其name属性定位到这个元素。定位到用户名输入框后，需要对其赋值。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#通过name()方法定位页面元素，输入用户名</span></span><br></pre></td></tr></table></figure>

<h2 id="xpath定位"><a href="#xpath定位" class="headerlink" title="xpath定位"></a>xpath定位</h2><blockquote>
<p>xpath定位是一种路径定位方式，主要依赖元素通过绝对路径或者相关路径来定位，当进行手动编写路径的时候，由于绝对路径需要从头到尾一级一级地往下编写，当遇到元素路径比较深的时候，写起来很麻烦，而且容易出错，且绝对路径xpath执行效率比较低，一般使用比较少。通常使用xpath相对路径和属性定位。由于这里用到有关于网页元素的相关知识（即XML知识），因此下面对这些知识进行讲解。</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">我们将在下面的例子中使用如下XML文档。</span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bookstore</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">title</span> <span class="attr">lang</span>=<span class="string">&quot;eng&quot;</span>&gt;</span>Harry Potter<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">price</span>&gt;</span>29.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">title</span> <span class="attr">lang</span>=<span class="string">&quot;eng&quot;</span>&gt;</span>Learning XML<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">price</span>&gt;</span>39.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bookstore</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>1）选取节点：xpath使用路径表达式在XML文档中选取节点，xpath路径表达式及其描述如表所示。</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026095729734.png" alt="image-20221026095729734" title="">
                </div>
                <div class="image-caption">image-20221026095729734</div>
            </figure>

<blockquote>
<p>2）选取未知节点：xpath通配符可用来选取未知的XML元素，xpath通配符及其描述，如表所示。</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026095747661.png" alt="image-20221026095747661" title="">
                </div>
                <div class="image-caption">image-20221026095747661</div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026095757202.png" alt="image-20221026095757202" title="">
                </div>
                <div class="image-caption">image-20221026095757202</div>
            </figure>

<blockquote>
<p>3）选取若干路径：通过在路径表达式中使用“|”运算符，可以选取若干路径。在表中列出了一些路径表达式及其结果。</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026095834596.png" alt="image-20221026095834596" title="">
                </div>
                <div class="image-caption">image-20221026095834596</div>
            </figure>

<blockquote>
<p>上面的定位方式都是通过元素的某个属性来定位的，还可以通过路径导航实现某个元素的定位，这个时候就可以用xpath解决。<br>xpath是一种路径语言，除了上面讲到的手工编写外，还可以直接复制到xpath的路径，然后编写脚本。<br>以人力资源综合服务系统登录页面为例，如图所示。格式：find_element_by_xpath(“”)</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026095859089.png" alt="image-20221026095859089" title="">
                </div>
                <div class="image-caption">image-20221026095859089</div>
            </figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_css_selector(<span class="string">&#x27;#password&#x27;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#通过css_selector()方法定位页面元素，输入用户名</span></span><br></pre></td></tr></table></figure>

<h2 id="css-selector定位"><a href="#css-selector定位" class="headerlink" title="css_selector定位"></a>css_selector定位</h2><blockquote>
<p>css_selector定位是另外一种通过路径导航实现某个元素的定位方法，此方法比xpath更为简洁，运行速度更快。可以通过定位到某个页面元素后，直接右击选择相应命令，然后进行脚本编写。<br>以人力资源综合服务系统登录页面为例，如图所示。格式：find_element_by_css_selecto(“”)</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026095955998.png" alt="image-20221026095955998" title="">
                </div>
                <div class="image-caption">image-20221026095955998</div>
            </figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_css_selector(<span class="string">&#x27;#password&#x27;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#通过css_selector()方法定位页面元素，输入用户名</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="link-text定位"><a href="#link-text定位" class="headerlink" title="link_text定位"></a>link_text定位</h2><blockquote>
<p>link_text是根据超链接的文本来定位，如果要单击超链接文本，进行从一个页面跳转到另元素定位方外一个页面，那么可以使用此元素定位方式进行定位。<br>以人力资源综合服务系统中的人资工作台按钮为例，右击查看元素，如图所示。通过元素属性可以分析出，当标签属性为a，且href &#x3D;”&#x2F;suthr&#x2F;home”，说明它是个超链接，对于这种元素，可以用link_text方法。格式：find_element_by_link_text(“”)</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026100033560.png" alt="image-20221026100033560" title="">
                </div>
                <div class="image-caption">image-20221026100033560</div>
            </figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名和密码；</span><br><span class="line">（<span class="number">3</span>）单击“登录”按钮；</span><br><span class="line">（<span class="number">4</span>）单击“人资工作台”按钮。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"><span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;loginBtn&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line">文前-<span class="number">04.</span>indd <span class="number">155</span> <span class="number">2021</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">12</span>:01:<span class="number">53</span></span><br><span class="line">Web 应用软件测试（中级） </span><br><span class="line"><span class="number">156</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;人资工作台&quot;</span>).click()</span><br><span class="line"><span class="comment">#通过link_text()方法定位页面元素，进入人资工作台页面</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="partial-link-text定位"><a href="#partial-link-text定位" class="headerlink" title="partial_link_text定位"></a>partial_link_text定位</h2><blockquote>
<p>上面讲的link_text定位方法是找到超链接文本进行定位，有时一个超链接文本的字符串可能比较长，如果输入全称，会显示很长，占用编写脚本地方，而且不好看，这时可以用partial_link_text定位。这是一种模糊匹配方式，只要截取超链接文本中一部分字符串即可。<br>以人力资源综合服务系统中的人资工作台按钮为例，右击查看元素，如图所示。从图中可以看出，当要通过“人资工作台”进行定位的时候，只需输入“工作台”即可。格式：find_element_by_partial_link_text(“”)</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026100133687.png" alt="image-20221026100133687" title="">
                </div>
                <div class="image-caption">image-20221026100133687</div>
            </figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名和密码；</span><br><span class="line">（<span class="number">3</span>）单击“登录”按钮；</span><br><span class="line">（<span class="number">4</span>）单击“人资工作台”按钮。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"><span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;loginBtn&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line">driver.find_element_by_partial_link_text(<span class="string">&quot;工作台&quot;</span>).click()</span><br><span class="line"><span class="comment">#通过partial_link_text()方法定位页面元素，进入人资工作台页面</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="class-name定位"><a href="#class-name定位" class="headerlink" title="class_name定位"></a>class_name定位</h2><blockquote>
<p>在编写自动化脚本的时候，如果某个页面元素既没有id属性，也没有name属性，但可以在定位的页面中找到class&#x3D;””元素，那么就可以使用class_name元素实现定位。<br>以人力资源综合服务系统页面左侧的“培训进修”按钮为例，右击查看元素，如图所示。从图中定位到的元素属性可以看到有个class属性：class&#x3D;”icon-badge”，这里可以通过它的class属性定位到这个元素。格式：find_element_by_class_name(“”)</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026100209167.png" alt="image-20221026100209167" title="">
                </div>
                <div class="image-caption">image-20221026100209167</div>
            </figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名和密码；</span><br><span class="line">（<span class="number">3</span>）单击“登录”按钮；</span><br><span class="line">（<span class="number">4</span>）单击页面左侧的“培训进修”按钮。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"><span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;loginBtn&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;icon-badge&quot;</span>).click()</span><br><span class="line"><span class="comment">#通过class_name()方法定位页面元素，进入培训进修页面</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>特殊情况：在HTML脚本中，会出现class属性中出现空格的情况，如图所示。<br>对于这种出现空格的情况，实际上是class属性中出现多个名字，空格前面一个名字，空格后面一个名字，在定位的时候用哪个名字都可以。</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026100253396.png" alt="image-20221026100253396" title="">
                </div>
                <div class="image-caption">image-20221026100253396</div>
            </figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">实例<span class="number">2</span>：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;form-control&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#输入用户名</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="tag-name定位"><a href="#tag-name定位" class="headerlink" title="tag_name定位"></a>tag_name定位</h2><blockquote>
<p>HTML的本质就是通过tag来定义实现不同的功能，每一个元素本质上也是一个tag。tag往往用来定义一类功能，所以通过tag识别某个元素的概率很低，因此用得比较少。例如，页面中存在大量的<div>、<input>、<a>等tag。<br>以人力资源综合服务系统登录页面的“登录”按钮为例，先打开人力资源系统登录页面，选择“登录”按钮，右击查看元素，如图所示。从图中定位到的元素属性可以看到有个area属性：&lt;button type&#x3D;”submit” class&#x3D;”submit_btn”style&#x3D;””&gt;登录</button>，area是页面中独一无二的元素，这里可以通过它的area属性定位到这个元素。</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026100331104.png" alt="image-20221026100331104" title="">
                </div>
                <div class="image-caption">image-20221026100331104</div>
            </figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）单击“登录”按钮。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_tag_name(<span class="string">&quot;button&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="复数元素定位"><a href="#复数元素定位" class="headerlink" title="复数元素定位"></a>复数元素定位</h1><blockquote>
<p>八种基本定位方式对应的复数形式如下：<br>●　id复数定位find_elements_by_id( )；<br>●　name复数定位find_elements_by_name( )；<br>●　class复数定位find_elements_by_class_name( )；<br>●　tag复数定位find_elements_by_tag_name( )；<br>●　link复数定位find_elements_by_link_text( )；<br>●　partial_link复数定位find_elements_by_partial_link_text( )；<br>●　xpath复数定位find_elements_by_xpath( )；<br>●　css复数定位find_elements_by_css_selector( )。</p>
</blockquote>
<blockquote>
<p>这些复数定位方式每次取到的都是具有相同类型属性的一组元素，所以返回的是一个list队列，也可以利用这个队列去定位单个元素。<br>以人力资源综合服务系统登录页面为例，如图所示。	从图中我们可以看出，用户名输入框和密码输入框都有共同的标签input。定位到的元素属性中可以看到用户名输入框在页面排第一个，通过复数定位的代码为：driver.find_elements_by_tag_name(“input”)[0].send_keys(“hrteacher”)</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026100504713.png" alt="image-20221026100504713" title="">
                </div>
                <div class="image-caption">image-20221026100504713</div>
            </figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名；</span><br><span class="line">（<span class="number">3</span>）输入密码。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_elements_by_tag_name(<span class="string">&quot;input&quot;</span>)[<span class="number">0</span>].send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#通过driver.find_elements_by_tag_name定位页面元素，输入用户名</span></span><br><span class="line">driver.find_elements_by_tag_name(<span class="string">&quot;input&quot;</span>)[<span class="number">1</span>].send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"><span class="comment">#通过driver.find_elements_by_tag_name定位页面元素，输入密码</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="鼠标操作"><a href="#鼠标操作" class="headerlink" title="鼠标操作"></a>鼠标操作</h1><blockquote>
<p>ActionChains基本能够满足所有对鼠标操作的需求。使用此类中的方法时，需要先引入此类，引入代码为：selenium.webdriver.common.action_chains.ActionChains(driver)<br>需要了解ActionChains的执行原理，当调用ActionChains( )方法时，不会立即执行，而是会将所有的操作按顺序存放在一个队列里，当调用perform( )方法时，按照队列里面的顺序进行执行。其中调用的perform( )方法必须放在ActionChains方法最后。<br>这种情况下可以有两种调用方法，两种写法本质是一样的，ActionChains都会按照顺序执行所有的操作。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>．链式写法</span><br><span class="line">menu=driver.find_element_by_css_selector(<span class="string">&quot;.nav&quot;</span>)</span><br><span class="line">hidden_submenu=driver.find_element_by_css_selector(<span class="string">&quot;.nav #submenu1&quot;</span>)</span><br><span class="line">ActionChains(driver).move_to_element(menu).click(hidden_submenu).perform()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>．分步写法</span><br><span class="line">menu=driver.find_element_by_css_selector(<span class="string">&quot;.nav&quot;</span>)</span><br><span class="line">hidden_submenu=driver.find_element_by_css_selector(<span class="string">&quot;.nav #submenu1&quot;</span>)</span><br><span class="line">actions=ActionChains(driver)</span><br><span class="line">actions.move_to_element(menu)</span><br><span class="line">actions.click(hidden_submenu)</span><br><span class="line">actions.perform()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="键盘操作"><a href="#键盘操作" class="headerlink" title="键盘操作"></a>键盘操作</h1><blockquote>
<p>Keys基本能够满足对键盘基本操作的需求。模拟键盘的操作需要先引入键盘模块，引入脚本为：<br>from selenium.webdriver.common.keys import Keys<br>在使用Keys方法时，可以分为两大类：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">（<span class="number">1</span>）先使用ActionChains类将鼠标移动到需要进行键盘操作的位置，然后进行键盘操作，如以下代码：</span><br><span class="line">ActionChains(driver).send_keys(Keys.TAB).send_keys(Keys.ENTER).perform()</span><br><span class="line"><span class="comment">#对定位到的元素进行回车操作</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">（<span class="number">2</span>）先通过元素定位方式进行元素定位，然后通过send_keys()进行键盘操作，如以下代码：</span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).send_keys(Keys.ENTER)</span><br><span class="line"><span class="comment">#模拟Enter键操作回车按钮</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Keys方法列表如表所示。</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026100726333.png" alt="image-20221026100726333" title="">
                </div>
                <div class="image-caption">image-20221026100726333</div>
            </figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名和密码，单击“登录”按钮；</span><br><span class="line">（<span class="number">3</span>）单击系统页面中的“培训进修”按钮；</span><br><span class="line">（<span class="number">4</span>）在培训内容输入框中输入信息dd；</span><br><span class="line">（<span class="number">5</span>）全选信息；</span><br><span class="line">（<span class="number">6</span>）复制信息；</span><br><span class="line">（<span class="number">7</span>）粘贴信息两次；</span><br><span class="line">（<span class="number">8</span>）过鼠标的形式单击“查询”按钮。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)<span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)<span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)<span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click()<span class="comment">#单击“登录”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;培训进修&quot;</span>).click()<span class="comment">#单击“培训进修”按钮</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;content&quot;</span>).send_keys(<span class="string">&quot;dd&quot;</span>)<span class="comment">#在培训内容输入框输入信息</span></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;content&quot;</span>).send_keys(Keys.CONTROL,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)<span class="comment">#全选信息</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;content&quot;</span>).send_keys(Keys.CONTROL,<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)<span class="comment">#复制信息</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;content&quot;</span>).send_keys(Keys.CONTROL,<span class="string">&#x27;v&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)<span class="comment">#粘贴信息</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;content&quot;</span>).send_keys(Keys.CONTROL,<span class="string">&#x27;v&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)<span class="comment">#粘贴信息</span></span><br><span class="line">ActionChains(driver).send_keys(Keys.TAB).send_keys(Keys.TAB).send_keys(Keys.</span><br><span class="line">TAB).send_keys(Keys.ENTER).perform()<span class="comment">#单击“查询”按钮</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="时间等待方法"><a href="#时间等待方法" class="headerlink" title="时间等待方法"></a>时间等待方法</h1><blockquote>
<p>测试过程中，会发现脚本执行的时候展现出来的效果都是很快结束，此时可以增加一个等待时间来观察执行效果。这种等待时间只是为了便于观察，这种情况下是否包含等待时间不会影响执行结果，但是有一种情况会直接影响执行结果。在打开一个网站的时候，由于环境的因素导致页面没有加载完成，此时去定位元素无法找到元素，这种情况下增加等待时间就会显得万分重要。本任务针对时间等待处理进行介绍。</p>
</blockquote>
<blockquote>
<p>Selenium主要提供WebDriverWait和Implicit Wait两种模式的等待，但是Python time模块也提供一种非智能的sleep( )等待，使用这个设置以后必须强制等待设置的时间，只有等待时间结束才会继续执行。这种模式一般会用于观察执行效果的时候，而WebDriverWait和Implicit Wait这两种时间等待属于智能等待。</p>
</blockquote>
<h2 id="显式等待"><a href="#显式等待" class="headerlink" title="显式等待"></a>显式等待</h2><p>例如：element&#x3D;WebDriverWait(driver,10).until(lambda x: x.find_element_by_id(“someId”))<br>is_disappeared&#x3D;WebDriverWait(driver,30,1,(ElementNotVisibleException)).<br>until_not(lambda x: x.find_element_by_id(“someId”).is_displayed())<br>注意：until是固定格式，可以理解为直到元素定位到为止；lambda x:x是一个匿名函数构建的方法，这里不太好理解，可以理解为固定格式，最后接定位方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">例如：element=WebDriverWait(driver,<span class="number">10</span>).until(<span class="keyword">lambda</span> x: x.find_element_by_id(<span class="string">&quot;someId&quot;</span>))</span><br><span class="line">is_disappeared=WebDriverWait(driver,<span class="number">30</span>,<span class="number">1</span>,(ElementNotVisibleException)).</span><br><span class="line">until_not(<span class="keyword">lambda</span> x: x.find_element_by_id(<span class="string">&quot;someId&quot;</span>).is_displayed())</span><br><span class="line">注意：until是固定格式，可以理解为直到元素定位到为止；<span class="keyword">lambda</span> x:x是一个匿名函数构建的方法，这里不太好理解，可以理解为固定格式，最后接定位方法。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>WebDriverWait( )</code>一般由<code>unit( )</code>或<code>until_not( )</code>方法配合使用。<br>●　<code>until(method, message=&#39;&#39;)</code>调用该方法提供的驱动程序作为一个参数，直到返回值不为False；<br>●　<code>until_not(method, message=&#39;&#39;)</code>调用该方法提供的驱动程序作为一个参数，直到返回值为False。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">实例<span class="number">1</span>：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名和密码；</span><br><span class="line">（<span class="number">3</span>）单击“登录”按钮，设置时间等待。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.wait <span class="keyword">import</span> WebDriverWait</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"><span class="comment">#输入密码</span></span><br><span class="line">element=WebDriverWait(driver,<span class="number">10</span>).until(<span class="keyword">lambda</span> x:x.find_element_by_id(<span class="string">&quot;loginBtn&quot;</span>))</span><br><span class="line"><span class="comment">#定位“登录”按钮并设置时间等待</span></span><br><span class="line">element.click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="强制等待"><a href="#强制等待" class="headerlink" title="强制等待"></a>强制等待</h2><p>设置等待最简单的方法就是强制等待，也就是sleep( )方法。它可以让程序暂停运行一定时间，时间过后继续运行。其缺点是不智能，如果设置的时间太短，元素还没有加载出来，则照样会报错；如果设置的时间太长，则会浪费时间。如果代码量过大，多个强制等待会影响整体的运行速度。<br>    使用强制等待sleep( )需要导入sleep。代码如下：<code>from time import sleep</code>。使用格式：sleep()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">实例<span class="number">2</span>：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名和密码，设置时间等待；</span><br><span class="line">（<span class="number">3</span>）单击“登录”按钮。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"><span class="comment">#输入密码</span></span><br><span class="line">sleep(<span class="number">5</span>)</span><br><span class="line"><span class="comment">#时间等待</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="隐式等待"><a href="#隐式等待" class="headerlink" title="隐式等待"></a>隐式等待</h2><p>隐性等待就是设置一个等待时间范围，这个等待时间是不固定的，最长的等待时间是设置的最大值。隐性等待也称智能等待，是Selenium提供的一个超时等待。它等待一个元素被发现，或一个命令完成，如果超出设置时间则抛出异常。<br>    使用格式：driver.implicitly_wait()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">实例<span class="number">3</span>：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面，设置时间等待；</span><br><span class="line">（<span class="number">2</span>）输入用户名和密码；</span><br><span class="line">（<span class="number">3</span>）单击“登录”按钮。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.implicitly_wait(<span class="number">30</span>)</span><br><span class="line"><span class="comment">#时间等待</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"><span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="窗口切换"><a href="#窗口切换" class="headerlink" title="窗口切换"></a>窗口切换</h1><p>有些页面的链接打开后会重新打开一个窗口，想在新页面上操作就得先切换窗口。获取窗口的唯一标识用句柄表示，所以只需要切换句柄，就能在多个页面上灵活操作。本任务针对窗口切换进行介绍。<br>以人力资源综合服务系统为例，单击门户首页，在门户首页中单击“论坛”按钮，发现右侧多出一个窗口标签，如图所示。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026104123086.png" alt="image-20221026104123086" title="">
                </div>
                <div class="image-caption">image-20221026104123086</div>
            </figure>

<p>元素有属性，浏览器的窗口也有属性，浏览器窗口的属性可以用脚本(handle)来识别。对于初学者来说，可以将窗口切换分为四步进行：（1）获取第一个窗口的名字，代码为：<code>print(driver.current_window_handle)</code></p>
<p>（2）获取所有窗口的名字，代码为：<code>print(driver.window_handles)</code></p>
<p>（3）获取到第二个窗口的名字，代码为：<code>print(driver.window_handles[1])</code></p>
<p>（4）进行窗口切换，代码为：<code>driver.switch_to.window(driver.window_handles[1])</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名和密码，单击“登录”按钮；</span><br><span class="line">（<span class="number">3</span>）单击页面上面的“人资工作台”按钮；</span><br><span class="line">（<span class="number">4</span>）单击页面左侧的“论坛后台管理”按钮；</span><br><span class="line">（<span class="number">5</span>）单击“举报处理”按钮；</span><br><span class="line">（<span class="number">6</span>）单击“回帖举报”按钮；</span><br><span class="line">（<span class="number">7</span>）单击回帖举报页面中的“举报流水”按钮；</span><br><span class="line">（<span class="number">8</span>）关闭新弹出的标签页。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)<span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.implicitly_wait(<span class="number">30</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)<span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)<span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click()<span class="comment">#单击“登录”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;人资工作台&quot;</span>).click()<span class="comment">#单击“人资工作台”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;论坛后台管理&quot;</span>).click()<span class="comment">#单击“论坛后台管理”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;举报处理&quot;</span>).click()<span class="comment">#单击“举报处理”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;回帖举报&quot;</span>).click()<span class="comment">#单击“回帖举报”按钮</span></span><br><span class="line">driver.find_element_by_xpath(<span class="string">&quot;/html/body/div[4]/div[2]/div/div[2]/div/div/div[2]</span></span><br><span class="line"><span class="string">/div[2]/table/tbody/tr[1]/td[10]/a[1]&quot;</span>).click()<span class="comment">#单击“举报流水”按钮</span></span><br><span class="line"><span class="built_in">print</span>(driver.current_window_handle)<span class="comment"># 获取第一个窗口的名字</span></span><br><span class="line"><span class="built_in">print</span>(driver.window_handles)<span class="comment"># 获取所有窗口的名字</span></span><br><span class="line"><span class="built_in">print</span>(driver.window_handles[<span class="number">1</span>])<span class="comment"># 获取到第二个窗口的名字,Window_handle[1]用到数组的原理</span></span><br><span class="line">driver.switch_to.window(driver.window_handles[<span class="number">1</span>])<span class="comment">#进行窗口切换</span></span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line">driver.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="页面元素删除"><a href="#页面元素删除" class="headerlink" title="页面元素删除"></a>页面元素删除</h1><p>对于单击某个链接后是否弹出新窗口，可以通过图1和图2所示的HTML代码进行比较。通过观察两个窗口中页面HTML代码的区别，以及通过删除弹出新窗口中的某个属性后，再次单击弹出新窗口的超链接，得出的结论是有target属性就会弹出新的窗口。<br>要想让链接不弹出新窗口，只需在代码执行时删除target属性即可。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026104226339.png" alt="image-20221026104226339" title="">
                </div>
                <div class="image-caption">image-20221026104226339</div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026104245875.png" alt="image-20221026104245875" title="">
                </div>
                <div class="image-caption">image-20221026104245875</div>
            </figure>

<p>target属性删除步骤（以人力资源综合服务系统门户首页中的论坛按钮为例）：</p>
<p>（1）用Selenium定位“目标”链接：<code>login_link=driver.find_element_by_XX(&quot;目标&quot;)</code>；</p>
<p>（2）删除已找到的页面元素的target属性：<code>driver.execute_script(&quot;arguments[0].removeAttribute(&#39;target&#39;)&quot;,login_link)</code>，其中<code>arguments[0]</code>的意思就是去字符串后面的第一个参数<code>login_link</code>的真正的值；</p>
<p>（3）单击删除target属性后的页面元素：<code>login_link.click()</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名和密码，单击“登录”按钮；</span><br><span class="line">（<span class="number">3</span>）单击人力资源服务系统页面的“人资工作台”按钮；</span><br><span class="line">（<span class="number">4</span>）在人资工作台页面单击左侧的“论坛后台管理”按钮；</span><br><span class="line">（<span class="number">5</span>）单击“主题及回帖管理”按钮；</span><br><span class="line">（<span class="number">6</span>）单击“回帖管理”按钮（要求不弹出新的标签页，在一个标签页中显示）。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)<span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.implicitly_wait(<span class="number">30</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)<span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)<span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;人资工作台&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“人资工作台”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;论坛后台管理&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“论坛后台管理”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;主题及回帖管理&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“主题及回帖管理”按钮</span></span><br><span class="line">element=driver.find_element_by_xpath(<span class="string">&quot;/html/body/div[4]/div[2]/div/div[2]/div/div/</span></span><br><span class="line"><span class="string">div[2]/div[2]/table/tbody/tr[1]/td[10]/a[2]&quot;</span>)</span><br><span class="line"><span class="comment">#用selenium定位回帖管理链接信息</span></span><br><span class="line">driver.execute_script(<span class="string">&quot;arguments[0].removeAttribute(&#x27;target&#x27;)&quot;</span>,element)</span><br><span class="line"><span class="comment">#删除已找到的回帖管理页面元素的targer属性</span></span><br><span class="line">element.click()</span><br><span class="line"><span class="comment">#单击删除targer属性后，进入回帖管理页面</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221027134238427.png" alt="image-20221027134238427" title="">
                </div>
                <div class="image-caption">image-20221027134238427</div>
            </figure>

<h1 id="submit-方法使用"><a href="#submit-方法使用" class="headerlink" title="submit()方法使用"></a>submit()方法使用</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026104351337.png" alt="image-20221026104351337" title="">
                </div>
                <div class="image-caption">image-20221026104351337</div>
            </figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；</span><br><span class="line">（<span class="number">2</span>）输入用户名和密码；</span><br><span class="line">（<span class="number">3</span>）单击“登录”按钮。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入到人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"><span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;loginBtn&quot;</span>).submit()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="操作下拉滚动条"><a href="#操作下拉滚动条" class="headerlink" title="操作下拉滚动条"></a>操作下拉滚动条</h1><p>在Selenium中提供两种方法来处理拖动下拉滚动条的问题。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>．通过连续按方向箭头的方法实现</span><br><span class="line">根据鼠标和键盘的相关知识和操作命令，可以借助于鼠标和键盘的操作命令来实现下拉滚动条的移动。例如，进入某个页面后存在下拉滚动条，且能够移动，则可以通过鼠标和键盘的操作命令找到隐藏的文字进行超链接，代码如下：</span><br><span class="line">ActionChains(driver).send_keys(Keys.ARROW_DOWN).send_keys(Keys.ARROW_DOWN).</span><br><span class="line">send_keys(Keys.ARROW_DOWN).perform()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>．用 JavaScript 中的语句实现滚动条移动</span><br><span class="line">JavaScript也是编写自动化脚本的一种语言，编写脚本的时候用得比较少，但是有的时候用JavaScript写的代码更加简单、实用。关于JavaScript的知识可以从网上进行简单学习。代码如下：</span><br><span class="line">driver.execute_script(<span class="string">&quot;window.scrollTo(0,0)&quot;</span>)</span><br><span class="line">代码中的(<span class="number">0</span>,<span class="number">0</span>)代表页面横向和纵向的坐标。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>比如，人力资源综合服务系统页面中的人资工作台页面左侧，需要进行拖动下拉条后才能看见页面最下面的文字，如图所示。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026104458800.png" alt="image-20221026104458800" title="">
                </div>
                <div class="image-caption">image-20221026104458800</div>
            </figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">实例<span class="number">1</span>：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；操作下拉滚动条方法</span><br><span class="line">（<span class="number">2</span>）输入用户名和密码，单击“登录”按钮；</span><br><span class="line">（<span class="number">3</span>）单击“人资工作台”按钮，进入人资工作台页面；</span><br><span class="line">（<span class="number">4</span>）实现页面中滚动条的横向和纵向移动。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"><span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;人资工作台&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“人资工作台”按钮</span></span><br><span class="line">ActionChains(driver).send_keys(Keys.ARROW_DOWN).send_keys(Keys.ARROW_DOWN).send_</span><br><span class="line">keys(Keys.ARROW_DOWN).send_keys(Keys.ARROW_DOWN).send_keys(Keys.ARROW_DOWN).perform()</span><br><span class="line"><span class="comment">#滚动条移动</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026104458800.png" alt="image-20221026104458800" title="">
                </div>
                <div class="image-caption">image-20221026104458800</div>
            </figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">实例<span class="number">2</span>：</span><br><span class="line">（<span class="number">1</span>）进入人力资源综合服务系统登录页面；操作下拉滚动条方法</span><br><span class="line">（<span class="number">2</span>）输入用户名和密码，单击“登录”按钮；</span><br><span class="line">（<span class="number">3</span>）单击“人资工作台”按钮，进入人资工作台页面；</span><br><span class="line">（<span class="number">4</span>）实现页面中滚动条的横向和纵向移动。</span><br><span class="line">在PyCharm中进行代码编写：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"><span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;人资工作台&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“人资工作台”按钮</span></span><br><span class="line">driver.execute_script(<span class="string">&quot;window.scrollTo(0,400)&quot;</span>)</span><br><span class="line"><span class="comment">#滚动条移动</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="下拉框处理"><a href="#下拉框处理" class="headerlink" title="下拉框处理"></a>下拉框处理</h1><p>对于图1图2所示问题，可以用三种方法进行元素定位。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026104728402.png" alt="image-20221026104728402" title="">
                </div>
                <div class="image-caption">image-20221026104728402</div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026104737793.png" alt="image-20221026104737793" title="">
                </div>
                <div class="image-caption">image-20221026104737793</div>
            </figure>

<h2 id="使用选项元素标签定位"><a href="#使用选项元素标签定位" class="headerlink" title="使用选项元素标签定位"></a>使用选项元素标签定位</h2><p><code>实例1： （1）进入人力资源综合服务系统登录页面； （2）输入用户名和密码，单击“登录”按钮； （3）单击人力资源服务系统页面中的“人资工作台”按钮； （4）单击人资工作台页面左侧的“员工基本信息管理”按钮； （5）单击“员工信息管理”按钮； （6）在员工信息管理页面选择政治面貌为其他。 在PyCharm中进行代码编写：</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.implicitly_wait(<span class="number">30</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"><span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;人资工作台&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“人资工作台”按钮</span></span><br><span class="line">element=driver.find_element_by_link_text(<span class="string">&quot;员工基本信息管理&quot;</span>)</span><br><span class="line"><span class="comment">#定位“员工基本信息管理”按钮</span></span><br><span class="line">ActionChains(driver).click(element).perform()</span><br><span class="line"><span class="comment">#单击“员工基本信息管理”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;员工信息管理&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“员工信息管理”按钮</span></span><br><span class="line">driver.find_elements_by_tag_name(<span class="string">&quot;select&quot;</span>)[<span class="number">1</span>].click()</span><br><span class="line"><span class="comment">#单击select标签</span></span><br><span class="line">driver.find_elements_by_tag_name(<span class="string">&quot;option&quot;</span>)[<span class="number">8</span>].click()</span><br><span class="line"><span class="comment">#选择政治面貌并单击</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="直接通过xpath层级标签定位"><a href="#直接通过xpath层级标签定位" class="headerlink" title="直接通过xpath层级标签定位"></a>直接通过xpath层级标签定位</h2><p><code>实例2： （1）进入人力资源综合服务系统登录页面； （2）输入用户名和密码，单击“登录”按钮； （3）单击人力资源服务系统页面中的“人资工作台”按钮； （4）单击人资工作台页面左侧的“员工基本信息管理”按钮； （5）单击“员工信息管理”按钮； （6）在员工信息管理页面选择政治面貌为其他。 在PyCharm中进行代码编写：</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.implicitly_wait(<span class="number">30</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line"><span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"><span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;人资工作台&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“人资工作台”按钮</span></span><br><span class="line">element=driver.find_element_by_link_text(<span class="string">&quot;员工基本信息管理&quot;</span>)</span><br><span class="line"><span class="comment">#定位“员工基本信息管理”按钮</span></span><br><span class="line">ActionChains(driver).click(element).perform()</span><br><span class="line"><span class="comment">#单击“员工基本信息管理”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;员工信息管理&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“员工信息管理”按钮</span></span><br><span class="line">driver.find_element_by_xpath(<span class="string">&quot;/html/body/div[4]/div[2]/div/div[2]/div[2]/div/</span></span><br><span class="line"><span class="string">div/form/div/div[1]/div/div[3]/select/option[6]&quot;</span>).click()</span><br><span class="line"><span class="comment">#选择政治面貌并单击</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="导入Select模块"><a href="#导入Select模块" class="headerlink" title="导入Select模块"></a>导入Select模块</h2><p>使用Select模块的方法除上面介绍的方法外，Selenium还提供了更高级的方法，即导入Select模块，直接根据属性或索引定位。<br>（1）导入Select模块方法：from selenium.webdriver.support.select import Select;<br>（2）通过select选项的名称定位选择对应选项，如选择其他选项，使用如下命令：select_by_visible_text(“其他”)</p>
<p><code>实例3： （1）进入人力资源综合服务系统登录页面； （2）输入用户名和密码，单击“登录”按钮； （3）单击人力资源服务系统页面中的“人资工作台”按钮； （4）单击人资工作台页面左侧的“员工基本信息管理”按钮； （5）单击“员工信息管理”按钮； （6）在员工信息管理页面选择政治面貌为其他。 在PyCharm中进行代码编写：</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.select <span class="keyword">import</span> Select</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.implicitly_wait(<span class="number">30</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)<span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)<span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;人资工作台&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“人资工作台”按钮</span></span><br><span class="line">element=driver.find_element_by_link_text(<span class="string">&quot;员工基本信息管理&quot;</span>)</span><br><span class="line"><span class="comment">#定位“员工基本信息管理”按钮</span></span><br><span class="line">ActionChains(driver).click(element).perform()</span><br><span class="line"><span class="comment">#单击“员工基本信息管理”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;员工信息管理&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“员工信息管理”按钮</span></span><br><span class="line">select=driver.find_element_by_id(<span class="string">&quot;dictPoliticalStatus&quot;</span>)</span><br><span class="line"><span class="comment">#定位下拉框</span></span><br><span class="line">Select(select).select_by_visible_text(<span class="string">&quot;其他&quot;</span>)</span><br><span class="line"><span class="comment">#定位下拉框选项</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>实例4： （1）进入人力资源综合服务系统登录页面； （2）输入用户名和密码，单击“登录”按钮； （3）单击人力资源服务系统页面中的“人资工作台”按钮； （4）单击人资工作台页面左侧的“员工基本信息管理”按钮； （5）单击“员工信息管理”按钮； （6）在员工信息管理页面选择政治面貌为其他。 在PyCharm中进行代码编写：</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.select <span class="keyword">import</span> Select</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.1.228/suthr/logon&quot;</span>)<span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.implicitly_wait(<span class="number">30</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)<span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"><span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;人资工作台&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“人资工作台”按钮</span></span><br><span class="line">element=driver.find_element_by_link_text(<span class="string">&quot;员工基本信息管理&quot;</span>)</span><br><span class="line"><span class="comment">#定位“员工基本信息管理”按钮</span></span><br><span class="line">ActionChains(driver).click(element).perform()</span><br><span class="line"><span class="comment">#单击“员工基本信息管理”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;员工信息管理&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“员工信息管理”按钮</span></span><br><span class="line">select=driver.find_element_by_id(<span class="string">&quot;dictPoliticalStatus&quot;</span>)</span><br><span class="line"><span class="comment">#定位下拉框</span></span><br><span class="line">Select(select).select_by_value(<span class="string">&quot;261&quot;</span>)</span><br><span class="line"><span class="comment">#定位下拉框选项</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="csdn查到的"><a href="#csdn查到的" class="headerlink" title="csdn查到的"></a>csdn查到的</h2><h3 id="下拉框选项操作：Select"><a href="#下拉框选项操作：Select" class="headerlink" title="下拉框选项操作：Select"></a>下拉框选项操作：Select</h3><hr>
<p><strong>针对下拉框选项，可以直接获取下拉框中的值，然后再循环获取匹配，也可以直接通过元素定位直接操作。</strong></p>
<p>**针对select&#x2F;option这样下拉选择框，如图展示：<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="20210312190450849.png" alt="img" title="">
                </div>
                <div class="image-caption">img</div>
            </figure>，我们可以直接使用webdriver中的*<em>Select*<em>类去处理 。</em></em></p>
<p>**首先是引入*<em>Select*<em>类(两种引包方法)：</em></em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver.support.select <span class="keyword">import</span> Select</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> Select</span><br></pre></td></tr></table></figure>

<p>**ui.py文件中实际引入的也是 select下的**Select**类，所以我们引入ui包实际引入的还是*<em>Select*<em>类：</em></em></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xJRkVORzA0MDI=,size_16,color_FFFFFF,t_70.png" alt="img" title="">
                </div>
                <div class="image-caption">img</div>
            </figure>

<p>**源码中*<em>Select*<em>下有很多方法，专门用于处理下拉选择框操作：</em></em></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xJRkVORzA0MDI=,size_16,color_FFFFFF,t_70-16668556110361.png" alt="img" title="">
                </div>
                <div class="image-caption">img</div>
            </figure>

<ul>
<li><h3 id="options：返回属于该选择标签的所有选项列表"><a href="#options：返回属于该选择标签的所有选项列表" class="headerlink" title="options：返回属于该选择标签的所有选项列表"></a>options：返回属于该选择标签的所有选项列表</h3></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.select <span class="keyword">import</span> Select</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.w3school.com.cn/tiy/t.asp?f=html_select&#x27;</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">&quot;//a[contains(text(),&#x27;运行代码&#x27;)]&quot;</span>).click()</span><br><span class="line">iframeResult = driver.find_element_by_xpath(<span class="string">&quot;//iframe[@id=&#x27;iframeResult&#x27;]&quot;</span>)</span><br><span class="line">driver.switch_to.frame(iframeResult)</span><br><span class="line">result = Select(driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;body:nth-child(2) &gt; select:nth-child(1)&quot;</span>)).options</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> result:</span><br><span class="line">    <span class="built_in">print</span>(i.text)</span><br></pre></td></tr></table></figure>

<p> 运行后的结果：下拉选择框中的数据循环打印显示在控制台</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">F:\virtualEnvironment\venv\Scripts\python.exe F:/git/AuomationTest/AuomationTestProject/webTestAuomation/selenium_select.py</span><br><span class="line">Volvo</span><br><span class="line">Saab</span><br><span class="line">Opel</span><br><span class="line">Audi</span><br><span class="line"></span><br><span class="line">Process finished <span class="keyword">with</span> exit code <span class="number">0</span></span><br></pre></td></tr></table></figure>

<ul>
<li><h3 id="all-selected-options：返回属于此选择标签的所有选择的选项列表"><a href="#all-selected-options：返回属于此选择标签的所有选择的选项列表" class="headerlink" title="all_selected_options：返回属于此选择标签的所有选择的选项列表"></a>all_selected_options：返回属于此选择标签的所有选择的选项列表</h3></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">result = Select(driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;body:nth-child(2) &gt; select:nth-child(1)&quot;</span>)).all_selected_options</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> result:</span><br><span class="line">    <span class="built_in">print</span>(i.text)</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p> 运行后的结果：下拉选择框中循环打印被选中的的选项</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">F:\virtualEnvironment\venv\Scripts\python.exe F:/git/AuomationTest/AuomationTestProject/webTestAuomation/selenium_select.py</span><br><span class="line">Volvo</span><br><span class="line"></span><br><span class="line">Process finished <span class="keyword">with</span> exit code <span class="number">0</span> </span><br></pre></td></tr></table></figure>

<ul>
<li><h3 id="first-selected-option：该选择标签中的第一个选择的选项（或正常选择中当前选择的选项）"><a href="#first-selected-option：该选择标签中的第一个选择的选项（或正常选择中当前选择的选项）" class="headerlink" title="first_selected_option：该选择标签中的第一个选择的选项（或正常选择中当前选择的选项）"></a>first_selected_option：该选择标签中的第一个选择的选项（或正常选择中当前选择的选项）</h3></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">result = Select(driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;body:nth-child(2) &gt; select:nth-child(1)&quot;</span>)).first_selected_option</span><br><span class="line"><span class="built_in">print</span>(result.text)</span><br><span class="line">driver.quit() </span><br></pre></td></tr></table></figure>

<p> 运行后的结果：打印下拉框中第一个被选中的的选项</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">F:\virtualEnvironment\venv\Scripts\python.exe F:/git/AuomationTest/AuomationTestProject/webTestAuomation/selenium_select.py</span><br><span class="line">Volvo</span><br><span class="line"></span><br><span class="line">Process finished <span class="keyword">with</span> exit code <span class="number">0</span></span><br></pre></td></tr></table></figure>

<hr>
<p><strong>下面示例html代码：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;volvo&quot;</span>&gt;</span>Volvo<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;saab&quot;</span>&gt;</span>Saab<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;opel&quot;</span>&gt;</span>Opel<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;audi&quot;</span>&gt;</span>Audi<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><h3 id="select-by-value：选择所有值都与参数匹配的选项。"><a href="#select-by-value：选择所有值都与参数匹配的选项。" class="headerlink" title="select_by_value：选择所有值都与参数匹配的选项。"></a>select_by_value：选择所有值都与参数匹配的选项。</h3><p>例如： select_by_value(“volvo”)，选择的就是第一个：” <option value="volvo">Volvo</option> “</p>
</li>
<li><h3 id="select-by-index：选择给定索引处的选项。这是通过检查元素的“索引”属性来完成的。"><a href="#select-by-index：选择给定索引处的选项。这是通过检查元素的“索引”属性来完成的。" class="headerlink" title="select_by_index：选择给定索引处的选项。这是通过检查元素的“索引”属性来完成的。"></a>select_by_index：选择给定索引处的选项。这是通过检查元素的“索引”属性来完成的。</h3><p>例如：select_by_index(1)，选择的就是第二个：” <option value="saab">Saab</option> “</p>
</li>
<li><h3 id="select-by-visible-text：选择所有显示与参数匹配的文本的选项。"><a href="#select-by-visible-text：选择所有显示与参数匹配的文本的选项。" class="headerlink" title="select_by_visible_text：选择所有显示与参数匹配的文本的选项。"></a>select_by_visible_text：选择所有显示与参数匹配的文本的选项。</h3><p>例如：图片标蓝框处的文本信息 <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="20210312182917162.png)，select_by_visible_text(Audi" alt="img" title="">
                </div>
                <div class="image-caption">img</div>
            </figure>，选择的就是第四个：” <option value="audi">Audi</option> “</p>
</li>
</ul>
<p><strong>下面示例代码，仅供参考：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">result = Select(driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;body:nth-child(2) &gt; select:nth-child(1)&quot;</span>))</span><br><span class="line">result.select_by_index(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> result.all_selected_options:</span><br><span class="line">    <span class="built_in">print</span>(i.text)</span><br><span class="line">result.select_by_value(<span class="string">&quot;opel&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> result.all_selected_options:</span><br><span class="line">    <span class="built_in">print</span>(i.text)</span><br><span class="line">result.select_by_visible_text(<span class="string">&quot;Audi&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> result.all_selected_options:</span><br><span class="line">    <span class="built_in">print</span>(i.text)</span><br><span class="line">time.sleep(<span class="number">10</span>)</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p>  运行后的结果：每一个获到参数的方法全部都做了循环并打印到控制台</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">F:\virtualEnvironment\venv\Scripts\python.exe F:/git/AuomationTest/AuomationTestProject/webTestAuomation/selenium_select.py</span><br><span class="line">Saab</span><br><span class="line">Opel</span><br><span class="line">Audi</span><br><span class="line"></span><br><span class="line">Process finished <span class="keyword">with</span> exit code <span class="number">0</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>deselect_all：清除所有选定的条目。这仅在SELECT支持多个选择时才有效。</p>
</li>
<li><p>deselect_by_value：取消选择所有值都与参数匹配的选项。</p>
</li>
<li><p>deselect_by_index：取消选择给定索引处的选项。</p>
</li>
<li><p>deselect_by_visible_text：取消选择所有显示与参数匹配的文本的选项。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">result = Select(driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;body:nth-child(2) &gt; select:nth-child(1)&quot;</span>))</span><br><span class="line">result.deselect_by_index(<span class="number">1</span>)</span><br><span class="line">result.deselect_by_value(<span class="string">&quot;opel&quot;</span>)</span><br><span class="line">result.deselect_by_visible_text(<span class="string">&quot;Audi&quot;</span>)</span><br><span class="line">result.deselect_all()</span><br><span class="line">time.sleep(<span class="number">10</span>)</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p><strong>\deselect_xxxxxxx\开头的方法，就是取消选中操作的意思，如果没有指定值存在就会抛异常：</strong>NotImplementedError， <strong>取消的方法其实就是跟选中的方法一样操作，无非就是先选中后再进行取消操作，在此就不再多作叙述，可自行实操下效果…</strong></p>
<h1 id="文件上传处理"><a href="#文件上传处理" class="headerlink" title="文件上传处理"></a>文件上传处理</h1><p>在实现UI自动化测试过程中，文件上传操作也是常见功能之一。对于文件上传功能并没有用到新方法或函数，关键是思路。上传过程一般要打开一个本地窗口，然后从窗口选择本地文件添加。<br>在Selenium webdriver中文件上传并不复杂，只要定位“上传”按钮，找到input标签属性，如<input type="file" name="filename">，然后通send_keys添加本地文件路径即可。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026105024607.png" alt="image-20221026105024607" title="">
                </div>
                <div class="image-caption">image-20221026105024607</div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026105057491.png" alt="image-20221026105057491" title="">
                </div>
                <div class="image-caption">image-20221026105057491</div>
            </figure>

<p>文件上传处理方法使用</p>
<p><code>实例： （1）进入人力资源综合服务系统登录页面； （2）输入用户名和密码，单击“登录”按钮； （3）在人力资源服务系统页面单击“人资工作台”按钮； （4）在人资工作台页面单击左侧的“员工基本信息管理”按钮； （5）单击“员工照片管理”按钮； （6）在员工照片管理页面中单击“编辑”按钮，打开编辑页面； （7）在编辑页面中单击“选择本地文件”按钮，上传文件。 在PyCharm中进行代码编写：</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)<span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.implicitly_wait(<span class="number">30</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)<span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)<span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;upp ercase&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“登录”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;人资工作台&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“人资工作台”按钮</span></span><br><span class="line">a=driver.find_element_by_link_text(<span class="string">&quot;员工基本信息管理&quot;</span>)</span><br><span class="line"><span class="comment">#定位“员工基本信息管理”按钮</span></span><br><span class="line">ActionChains(driver).click(a).perform()</span><br><span class="line"><span class="comment">#单击“员工基本信息管理”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;员工照片管理&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“员工照片管理”按钮</span></span><br><span class="line">driver.find_element_by_xpath(<span class="string">&quot;/html/body/div[4]/div[2]/div/div[2]/div/div/div/</span></span><br><span class="line"><span class="string">div[2]/table/tbody/tr[1]/td[9]/a&quot;</span>).click()</span><br><span class="line"><span class="comment">#单击“编辑”按钮</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;file&quot;</span>).send_keys(<span class="string">r&quot;C:\Users\Public\Pictures\Sample </span></span><br><span class="line"><span class="string">Pictures\juehua.jpg&quot;</span>)</span><br><span class="line"><span class="comment">#上传文件处理</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="页面截图操作"><a href="#页面截图操作" class="headerlink" title="页面截图操作"></a>页面截图操作</h1><p>截图方法：<code>get_screenshot_as_file(self, filename)</code><br>代码如下：<code>driver.get_screenshot_as_file(r&quot;路径名\图片名字&quot;)</code></p>
<p><code>实例： （1）进入人力资源综合服务系统登录页面； （2）对登录页面进行截图操作。 在PyCharm中进行代码编写：</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logo&quot;</span>)</span><br><span class="line"><span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.get_screenshot_as_file(<span class="string">r&quot;C:\Users\Public\Pictures\Sample Pictures\denglu.png&quot;</span>)</span><br><span class="line"><span class="comment">#截图操作</span></span><br></pre></td></tr></table></figure>

<h1 id="alert对话框处理"><a href="#alert对话框处理" class="headerlink" title="alert对话框处理"></a>alert对话框处理</h1><p>当登录某些界面的时候，输入用户名和密码错误，会弹出一个alert（警告）对话框，如果不关闭该对话框就没法继续执行下去，所以无法通过定位的方式定位它的位置。<br>弹出对话框主要分为三种类型：“警告对话框”“确认对话框”，“提示对话框”。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221026105515248.png" alt="image-20221026105515248" title="">
                </div>
                <div class="image-caption">image-20221026105515248</div>
            </figure>

<p>1．警告对话框：警告对话框提供一个“确定”按钮让用户关闭该对话框，而且该对话框是模式对话框，也就是说，用户必须先关闭该对话框然后才能继续进行操作。<br>2．确认对话框：确认对话框向用户提示一个“是与否”问题，用户可以根据单击“确定”按钮和“取消”按钮。<br>3．提示对话框：提示对话框提供一个文本字段，用户可以在此字段输入一个答案来响应提示。有一个“确定”按钮和“取消”按钮。单击“确认”按钮会响应对应的提示信息，单击“取消”按钮会关闭对话框。<br>Selenium提供switch_to_alert( )方法定位到alert&#x2F;confirm&#x2F;prompt对话框。使用text&#x2F;accept&#x2F;dismiss&#x2F;send_keys进行操作，需要注意的是send_keys只能对prompt操作，因为只有它是要输入内容的。<br>text&#x2F;accept&#x2F;dismiss&#x2F;send_keys所代表的意思：<br>●　text( )#获取对话框文本值；<br>●　accept( )#相当于单击“确认”按钮；<br>●　dismiss( )#相当于单击“取消”按钮；<br>●　send_keys( )#输入值，这个alter和confirm没有输入对话框，所以这里不能用，只能用于prompt。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">例如，接受对话框：</span><br><span class="line">element=driver.switch_to_alert()</span><br><span class="line">element.accept()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">例如，得到对话框的文本消息，比如得到“请输入用户名”。</span><br><span class="line">element=driver.switch_to_alert().text</span><br><span class="line"><span class="built_in">print</span>(element)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">例如，“取消”按钮：</span><br><span class="line">element=driver.switch_to_alert()</span><br><span class="line">element.dismiss()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">例如，输入值：</span><br><span class="line">element=driver.switch_to_alert()</span><br><span class="line">element.send_keys(<span class="string">&quot;hello&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>alert对话框处理方法使用</p>
<p><code>实例： （1）进入人力资源综合服务系统登录页面； （2）输入用户名和密码，单击“登录”按钮； （3）单击人力资源综合服务系统页面中的“门户首页”按钮； （4）单击门户首页中的“论坛”按钮（始终在一个标签页中运行）； （5）单击论坛首页中的某个热门主题信息； （6）单击热门主题信息页面中最下面的“回复”按钮； （7）打印弹出警告对话框中的文字信息，并关闭警告对话框。 在PyCharm中进行代码编写：</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line">driver=webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logo&quot;</span>)<span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">driver.implicitly_wait(<span class="number">30</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)<span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)<span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;btn-success&quot;</span>).click()<span class="comment">#单击“登录”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;门户首页&quot;</span>).click()<span class="comment">#单击“门户首页”按钮</span></span><br><span class="line">a=driver.find_element_by_xpath(<span class="string">&quot;/html/body/div[3]/div[1]/div/div/div/div[2]/div[2]/div/a&quot;</span>)</span><br><span class="line">driver.execute_script(<span class="string">&quot;arguments[0].removeAttribute(&#x27;target&#x27;)&quot;</span>,a)</span><br><span class="line">a.click()<span class="comment">#单击“论坛”按钮</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;颠三倒四多&quot;</span>).click()<span class="comment">#单击热门主题信息</span></span><br><span class="line">driver.execute_script(<span class="string">&quot;window.scrollTo(0,2000)&quot;</span>)</span><br><span class="line">b=driver.find_element_by_id(<span class="string">&quot;replyBtn&quot;</span>)</span><br><span class="line">ActionChains(driver).click(b).perform()<span class="comment">#弹出警告对话框</span></span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line">element=driver.switch_to_alert().text<span class="comment">#打印弹出警告对话框文字</span></span><br><span class="line"><span class="built_in">print</span>(element)</span><br><span class="line">driver.switch_to_alert().accept()<span class="comment">#关闭警告对话框</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Unittest"><a href="#Unittest" class="headerlink" title="Unittest"></a>Unittest</h1><h2 id="Unittest工作原理"><a href="#Unittest工作原理" class="headerlink" title="Unittest工作原理"></a>Unittest工作原理</h2><p>Unittest最核心的是<code>TestCase、TestSuite、TestRunner、TestFixture</code>四部分。</p>
<ul>
<li>TestCase：用户自定义测试用例的基类，调用<code>run( )</code>方法时，会依次调用<code>setUp( )</code>方法、执行用例的方法、<code>tearDown( )</code>方法</li>
<li>TestSuite：测试用例集合，可以通过<code>addTest( )</code>方法手动增加<code>TestCase</code>，也可以通过<code>TestLoader</code>自动添加<code>TestCase</code>，<code>TestLoader</code>在添加用例时没有顺序</li>
<li>TestRunner：运行测试用例的驱动类，可以执行<code>TestCase</code>，也可以执行<code>TestSuite</code>，执行后<code>TestCase</code>和<code>TestSuite</code>会自动管理<code>TestResult</code></li>
<li>TestFixture：进行测试过程的准备活动，比如创建临时数据库、文件和目录等，其中<code>setUp( )</code>和<code>setDown( )</code>是最常用的方法</li>
</ul>
<h2 id="Unittest方法使用"><a href="#Unittest方法使用" class="headerlink" title="Unittest方法使用"></a>Unittest方法使用</h2><p>（1）写好<code>TestCase</code>：一个class继承<code>unittest.TestCase</code>，就是一个测试用例，其中有多个以<code>test</code>开头的方法，每个方法在<code>load</code>的时候会生成一个<code>TestCase</code>实例。如果一个<code>class</code>中有四个<code>test</code>开头的方法，则最后<code>load</code>到suite中时有四个测试用例。<br>（2）由<code>TestLoader</code>加载<code>TestCase</code>到<code>TestSuite</code>。<br>（3）由<code>TextTestRunner</code>运行<code>TestSuite</code>，运行结果保存在<code>TextTestResult</code>中。通过命令行或者<code>unittest.main( )</code>方法执行时，<code>main</code>会调用<code>TextTestRunner</code>中的<code>run()</code>方法来执行用例，或者可以直接通过<code>TextTestRunner</code>来执行用例。<code>Runner</code>执行时，默认将结果输出到控制台。可以设置其输出到文件，在文件中查看结果；也可以通过<code>HTMLTestRunne</code>r将结果输出到<code>HTML</code>。</p>
<h2 id="Unittest主要类关系"><a href="#Unittest主要类关系" class="headerlink" title="Unittest主要类关系"></a>Unittest主要类关系</h2><p>正常调用<code>Unittest</code>的流程是<code>TestLoader</code>自动将测试用例<code>TestCase</code>中加载到<code>TestSuite</code>里，<code>TextTestRunner</code>调用TestSuite的<code>run( )</code>方法，顺序执行其中的<code>TestCase</code>中以<code>test</code>开头的方法，并得到测试结<code>TestResult</code>。</p>
<p>在执行<code>TestCase</code>过程中，先通过<code>SetUp( )</code>方法进行环境准备，执行测试代码，最后通过<code>tearDown( )</code>方法进行测试的还原。</p>
<p><code>TestLoader</code>在加载过程中进行添加的<code>TestCase</code>是没有顺序的。一个<code>TestCase</code>里如果存在多个验证方法，会按照方法中<code>test</code>后方首字母的<code>ASCII</code>码从小到大排序后执行。</p>
<p>可以通过手动调用<code>TestSuite</code>的<code>addTest( )</code>、<code>addTest( )</code>方法来动态添加<code>TestCase</code>，这样既可以确定添加用例的执行顺序，也可避免<code>TestCase</code>中的验证方法一定要用<code>test</code>开头。</p>
<h2 id="Unittest框架使用说明"><a href="#Unittest框架使用说明" class="headerlink" title="Unittest框架使用说明"></a>Unittest框架使用说明</h2><p>（1）<code>import unittest</code> #导入测试框架：定义一个继承自<code>unittest.TestCase</code>的测试用例类。定义<code>setUp( )</code>方法、<code>tearDown( )</code>方法、<code>setUpClass( )</code>方法、<code>tearDownClass( )</code>方法。其中<code>setUp( )</code>方法指在每个测试用例方法执行前都会执行一次；<code>tearDown( )</code>方法指在每次测试用例方法执行结束后都会执行一次；<code>setUpClass( )</code>方法指在一个测试用例集执行前只执行一次；<code>tearDownClass( )</code>方法指在一个测试用例集执行后只执行一次。<br>（2）定义测试用例，名字以<code>test</code>开头：一个测试用例应该只测试一个方面，测试目的和测试内容应很明确。主要调用<code>assertEqual( )</code>、<code>assertRaises( )</code>等断言方法判断程序执行结果和预期值是否相符。<br>（3）调用<code>unittest.main( )</code>方法启动测试：如果测试未通过，会输出相应的错误提示；如果测试全部通过，则不显示任何东西。</p>
<h3 id="Unittest单元测试框架实例"><a href="#Unittest单元测试框架实例" class="headerlink" title="Unittest单元测试框架实例"></a>Unittest单元测试框架实例</h3><p><code>实例1： （1）分别定义四个方法：setUp( )、tearDown( )、test_denglu( )、test_denglu1( )； （2）使用setUp( )方法启动浏览器； （3）使用tearDown( )方法关闭浏览器； （4）使用test_denglu( )方法进入人力资源综合服务系统登录页面，输入账号和密码，单击“登录”按钮； （5）使用test_denglu1( )方法进入人力资源综合服务系统登录页面，输入账号和密码，单击“登录”按钮，在人力资源综合服务系统页面单击“门户首页”按钮。 在PyCharm中进行代码编写：</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest <span class="comment">#引入unittest</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Denglu</span>(unittest.TestCase):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUp</span>(<span class="params">self</span>): <span class="comment">#定义setUp()方法</span></span><br><span class="line">        self.driver=webdriver.Chrome()</span><br><span class="line">        self.driver.implicitly_wait(<span class="number">30</span>)</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">tearDown</span>(<span class="params">self</span>): <span class="comment">#定义tearDown()方法</span></span><br><span class="line">        self.driver.quit()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_denglu</span>(<span class="params">self</span>): <span class="comment">#定义test_denglu()方法</span></span><br><span class="line">        self.driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)</span><br><span class="line">        self.driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)</span><br><span class="line">        self.driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line">        self.driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click()</span><br><span class="line">        time.sleep(<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_denglu1</span>(<span class="params">self</span>): <span class="comment">#定义test_denglu1方法</span></span><br><span class="line">        self.driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>) <span class="comment">#进入人力资源综合服务系统登录页面</span></span><br><span class="line">        self.driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>) <span class="comment">#输入用户名 </span></span><br><span class="line">        self.driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)<span class="comment">#输入密码</span></span><br><span class="line">        self.driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click() <span class="comment">#单击“登录”按钮</span></span><br><span class="line">        self.driver.find_element_by_link_text(<span class="string">&quot;门户首页&quot;</span>).click()<span class="comment">#单击“门户首页”按钮</span></span><br><span class="line">        time.sleep(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    unittest.main()<span class="comment">#调用unittest.main()方法启动测试</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>实例2： （1）分别定义四个方法：setUpClass( )、tearDownClass( )、test_denglu( )、test_denglu1( )； （2）使用setUpClass( )方法启动浏览器； （3）使用tearDownClass( )方法关闭浏览器； （4）使用test_denglu( )方法进入人力资源综合服务系统登录页面，输入账号和密码，单击“登录”按钮； （5）使用test_denglu1( )方法进入人力资源综合服务系统页面，在人力资源综合服务系统页面单击“门户首页”按钮。 在PyCharm中进行代码编写：</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest <span class="comment">#引入unittest</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Denglu</span>(unittest.TestCase):</span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUpClass</span>(<span class="params">cls</span>): <span class="comment">#定义setUpClass()方法</span></span><br><span class="line">        cls.driver=webdriver.Chrome()</span><br><span class="line">        cls.driver.implicitly_wait(<span class="number">30</span>)</span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tearDownClass</span>(<span class="params">cls</span>): <span class="comment">#定义tearDownClass()方法</span></span><br><span class="line">        cls.driver.quit()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_denglu</span>(<span class="params">cls</span>): <span class="comment">#定义test_denglu()方法</span></span><br><span class="line">        cls.driver.get(<span class="string">&quot;http://192.168.X.XXX/suthr/logon&quot;</span>)<span class="comment">#进入人力资源综合服务系统登录页面 </span></span><br><span class="line">        cls.driver.find_element_by_name(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;hrteacher&quot;</span>)<span class="comment">#输入用户名 </span></span><br><span class="line">        cls.driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)<span class="comment">#输入密码</span></span><br><span class="line">        cls.driver.find_element_by_class_name(<span class="string">&quot;uppercase&quot;</span>).click()<span class="comment">#单击“登录”按钮</span></span><br><span class="line">        time.sleep(<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_denglu1</span>(<span class="params">cls</span>): <span class="comment">#定义test_denglu1()方法</span></span><br><span class="line">        cls.driver.find_element_by_link_text(<span class="string">&quot;门户首页&quot;</span>).click()<span class="comment">#单击“门户首页”按钮</span></span><br><span class="line">        time.sleep(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    unittest.main()</span><br><span class="line"><span class="comment">#调用unittest.main()方法启动测试</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="CSV文件读取"><a href="#CSV文件读取" class="headerlink" title="CSV文件读取"></a>CSV文件读取</h1><p>1．前期工作：在某个文件中创建一个Excel文件，放入三行数据，这里是姓名+年龄（可以自己随意写），然后另存为CSV文件格式。<br>2．读取步骤：（1）导入CSV代码库；（2）以只读形式打开文件；（3）由于打开文件的数据不能直接查看，所以要进行格式转换；（4）使用for循环打印除第一行标题之外的所有数据。</p>
<ol>
<li>案例1<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">实例<span class="number">1</span></span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>():</span><br><span class="line">    path=<span class="string">r&quot;./csvread1.csv&quot;</span></span><br><span class="line">    stream = <span class="built_in">open</span>(path,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    data = csv.reader(stream)</span><br><span class="line">    <span class="built_in">list</span> = []</span><br><span class="line">    i =<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">if</span> i != <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">list</span>.append(row)</span><br><span class="line">        i = i +<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">        data = read()</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> data:</span><br><span class="line">            <span class="built_in">print</span>(row)</span><br><span class="line"><span class="comment">##################################################### </span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li>案例2<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">实例<span class="number">2</span></span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getcsv</span>():</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;D:\\PythonProject\\项目自动化训练\\2022GZ\PoTest\\Page\\data.csv&quot;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    L=[]</span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    data = csv.reader(f)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">if</span> i!=<span class="number">0</span>:</span><br><span class="line">            L.append(j)</span><br><span class="line">        i=i+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(getcsv())</span><br><span class="line"></span><br><span class="line"><span class="comment"># import csv</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># def getCsv():</span></span><br><span class="line"><span class="comment">#     with open(&quot;./data.csv&quot;, encoding=&quot;utf8&quot;) as f:</span></span><br><span class="line"><span class="comment">#         f = csv.reader(f)</span></span><br><span class="line"><span class="comment">#         f.__next__()</span></span><br><span class="line"><span class="comment">#         data =[]</span></span><br><span class="line"><span class="comment">#         for t in f:</span></span><br><span class="line"><span class="comment">#             data.append(t)</span></span><br><span class="line"><span class="comment">#     return data</span></span><br><span class="line"><span class="comment">##################################################### </span></span><br><span class="line"><span class="meta">@ddt</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>(unittest.TestCase):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUp</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.lg = LoginPage()</span><br><span class="line">        self.lg.login(<span class="string">&#x27;student&#x27;</span>,<span class="string">&#x27;student&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @data(<span class="params">*csvv.getcsv(<span class="params"></span>)</span>)</span></span><br><span class="line"><span class="meta">    @unpack</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_add</span>(<span class="params">self,mingcheng,leibie</span>):</span><br><span class="line">        self.add = AddPage()</span><br><span class="line">        self.add.add(mingcheng,leibie)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tearDown</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.add.quit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure></li>
<li>案例3<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#读取csv文件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_csv_file</span>(<span class="params">line</span>):</span><br><span class="line">    <span class="comment"># 文件路径需要自己修改成自己的文件路径</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;C:\Users\蒋英羽\Desktop\任务11.4：Web端—系统管理员 - 副本 (2)\任务实训指导书答案及源码\基于python\源码\Website\test_data\ccs.csv&quot;</span>,encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        reader=csv.reader(file)</span><br><span class="line">        <span class="keyword">for</span> index,row <span class="keyword">in</span> <span class="built_in">enumerate</span>(reader,<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> index==line:</span><br><span class="line">                <span class="keyword">return</span> row</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    data=get_csv_file(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> data:</span><br><span class="line">        <span class="built_in">print</span>(row)</span><br><span class="line"><span class="comment">#######################################################</span></span><br><span class="line"><span class="meta">@ddt.ddt</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LoginTest</span>(myunit.StartEnd):</span><br><span class="line">  <span class="comment"># @unittest.skip(&#x27;skip this case&#x27;)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test01_add_success</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;操作成功&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;test case is start run...&quot;</span>)</span><br><span class="line">        test_date = function.get_csv_file(<span class="number">2</span>)</span><br><span class="line">        <span class="comment">#创建参数接收测试数据</span></span><br><span class="line">        test_user_login(self.driver,<span class="string">&#x27;hrteacher&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">        <span class="comment">#登录</span></span><br><span class="line">        test_user_add(self.driver,test_date[<span class="number">0</span>],test_date[<span class="number">1</span>])</span><br><span class="line">        <span class="comment">#输入测试数据</span></span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        function.inser_img(self.driver,<span class="string">&quot;test01_add_null.png&quot;</span>)</span><br><span class="line">        <span class="comment"># 截屏</span></span><br><span class="line">        po = UserAdd(self.driver)</span><br><span class="line">        <span class="comment"># 设置参数接收数据</span></span><br><span class="line">        self.assertIn(test_date[<span class="number">2</span>], po.type_tjcg())</span><br><span class="line">        <span class="comment"># 断言对比测试用例是否正确</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;test case is successful test end!&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="数据驱动"><a href="#数据驱动" class="headerlink" title="数据驱动"></a>数据驱动</h1><p>使用数据驱动模式，可以根据业务分解测试数据，只需定义变量，通过外部或者自定义的数据使其参数化，从而避免使用之前测试脚本中固定的数据。可以将测试脚本与测试数据分离，使得测试脚本在不同数据集合下高度复用。这不仅可以增加复杂条件场景的测试覆盖，还可以减少测试脚本的编写与维护工作。</p>
<p>1．环境准备：安装ddt代码库，打开cmd命令行窗口，输入<code>pip install ddt</code>命令在线安装。<br>2．数据驱动步骤<br>（1）在头部导入ddt代码库：<code>import ddt</code>；<br>（2）在测试类前添加一个装饰器，表示这个类采用ddt代码库的方式实现数据驱动（<code>@ddt.ddt</code>）；<br>（3）在测试方法前使用<code>@ddt.data( )</code>指定数据来源。<br>3．代码编写思路：首先将测试数据单独存放，然后在编写脚本时调用存放的数据，逐条进行数据的读取。</p>
<p><code>实例：</code><br><code>（1）进入人力资源综合服务系统登录页面；</code><br><code>（2）输入用户名和密码，单击“登录”按钮；</code><br><code>（3）单击人力资源综合服务系统页面左侧的“培训进修”按钮；</code><br><code>（4）在培训进修页面中的培训内容输入框中输入多组数据进行查询。</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> potest10_26_01.csvread <span class="keyword">import</span> read</span><br><span class="line"><span class="keyword">from</span> ddt <span class="keyword">import</span> ddt,data,unpack</span><br><span class="line"><span class="comment"># import csvread</span></span><br><span class="line"><span class="meta">@ddt</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ddt123</span>(unittest.TestCase):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUp</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver = webdriver.Chrome()</span><br><span class="line">        self.driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">    <span class="comment"># @data(*read())</span></span><br><span class="line">    <span class="comment"># @unpack</span></span><br><span class="line">    stream = read()</span><br><span class="line"><span class="meta">    @data(<span class="params">*stream</span>)</span></span><br><span class="line"><span class="meta">    @unpack</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test1</span>(<span class="params">self,lost,nlost2</span>):</span><br><span class="line">        self.driver.get(<span class="string">&quot;http://192.168.5.10/pams&quot;</span>)</span><br><span class="line">        self.driver.find_element(By.NAME, <span class="string">&quot;loginName&quot;</span>).send_keys(lost)</span><br><span class="line">        self.driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(nlost2)</span><br><span class="line">        self.driver.find_element(By.XPATH,<span class="string">&#x27;//*[@id=&quot;fmedit&quot;]/div[4]/button&#x27;</span>).click()</span><br><span class="line">        self.driver.find_element(By.PARTIAL_LINK_TEXT,<span class="string">&quot;资产报废&quot;</span>).click()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tearDown</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.quit()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><h4 id="python数据处理之-ddt，-data，-unpack"><a href="#python数据处理之-ddt，-data，-unpack" class="headerlink" title="python数据处理之 ddt，@data， @unpack"></a><a target="_blank" rel="noopener" href="https://www.cnblogs.com/nbnuan/articles/10656724.html">python数据处理之 ddt，@data， @unpack</a></h4><p>python 的unittest 没有自带数据驱动功能。</p>
<p>所以如果使用unittest，同时又想使用数据驱动，那么就可以使用DDT来完成。</p>
<p>DDT是 “Data-Driven Tests”的缩写，包含类的装饰器ddt和两个方法装饰器data（直接输入测试数据），file_data（可以从json或者yaml中获取测试数据）</p>
<hr>
<p>【通常情况下，data中的数据按照一个参数传递给测试用例，如果data中含有多个数据，以元组，列表，字典等数据，需要自行在脚本中对数据进行分解或者使用unpack分解数据】</p>
<p><strong>说明：</strong></p>
<p>@ddt 读取单个测试数据：—–装饰测试类，继承自TestCase的类</p>
<p>@data（）—装饰测试方法，拿到几个数据数据就执行几条用例（可以以“*变量”传入括号；也可以直接括号放入数值，逗号隔开）</p>
<p>　　　　@data(a,b)  ——那么a和b各运行一次用例</p>
<p>　　　　@data([a,d],[c,d]) —–如果没有unpack，那么[a,b]当成一个参数传入用例运行；如果有unpack，那么[a,b]被分解开，按照用例中的两个参数传递</p>
<p>　　　　@file_data(filename)  —-对于json的文件，每一个json元素按照一个用例运行，可以依照python分解元组，列表或者字典的方式分解传入</p>
<p>@unpack —-解包，使用复杂的数据结构时，与此同时，测试方法的参数需要多个（参数的传值个数与解包后数量必须一一对应，“可以考虑用None”）</p>
<p>　　　　　 　　如果test_data的值很多（大于5）不建议使用unpack，可以考虑直接列表传出，索引取值（要注意参数不对等的情况）</p>
<p>【注意】使用请先导包</p>
<p>1.传列表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import  unittest</span><br><span class="line">from ddt import  ddt,data,unpack</span><br></pre></td></tr></table></figure>



<ul>
<li>unpack 的作用</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@unpack    </span><span class="comment">#在“脱外套”之后，针对你拿到的每一条数据根据逗号进行拆分</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_print_data</span>(<span class="params">self,a,b</span>):  <span class="comment">#需要按拆出来的每条数据内的个数进行传参</span></span><br></pre></td></tr></table></figure>

<ul>
<li>参数名要和字典中的key对应</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  unittest</span><br><span class="line"><span class="keyword">from</span> ddt <span class="keyword">import</span>  ddt,data,unpack</span><br><span class="line">test_data=[&#123;<span class="string">&#x27;no&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;小李&#x27;</span>&#125;,&#123;<span class="string">&#x27;no&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;小张&#x27;</span>&#125;]</span><br><span class="line"></span><br><span class="line"><span class="meta">@ddt</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestMath</span>(unittest.TestCase):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUp</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @data(<span class="params">*test_data</span>)</span></span><br><span class="line"><span class="meta">    @unpack    </span><span class="comment">#在“脱外套”之后，针对你拿到的每一条数据根据逗号进行拆分</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_print_data</span>(<span class="params">self,a,b</span>):  <span class="comment">#需要按拆出来的每条数据内的个数进行传参</span></span><br><span class="line">        <span class="built_in">print</span>(a)</span><br><span class="line">        <span class="built_in">print</span>(b)</span><br><span class="line"></span><br><span class="line"><span class="comment">#结果会报错，参数名需要与你的字典key对应</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>也可以不使用@package 返回的就是一个数组，直接填写list就是数组内容的拼接 list[0] 就是数组中的第一个元素</p>
</blockquote>
<blockquote>
<p>执行的时候一定要用main方法</p>
</blockquote>
<h1 id="数据断言"><a href="#数据断言" class="headerlink" title="数据断言"></a>数据断言</h1><p>断言使用的主要是<code>assertEqual</code>方法，如何检查测试用例执行是否正确：<br>（1）通过比对页面元素的文本信息，检查测试用例执行结果的正确性，编写代码如下：<code>Find_element().text</code><br>（2）通过对比页面标题信息，检查测试用例执行结果的正确性，编写代码如下：<code>Driver.title</code><br>（3）通过对比网址信息，检查测试用例执行结果的正确性，编写代码如下：<code>Driver.current_url</code><br>（4）通过比对页面元素的属性信息，检查测试用例执行结果的正确性，编写代码如下：<code>FindElement().get_attribute(&quot;value&quot;)</code></p>
<p><code>实例1： 1、进入人力资源综合服务系统登录页面； 2、输入用户名和密码，点击登录按钮； 3、在人力资源综合服务系统页面点击人资工作台按钮； 4、在人资工作台页面点击页面左侧的员工基本信息管理按钮； 5、点击员工信息管理按钮； 6、在员工信息管理页面点击录入员工按钮； 7、在录入员工页面对身份证号进行不输入信息和输入错误信息的数据驱动和断言代码编写，并进行异常错误处理和对异常错误进行截图。 测试数据，如图所示，在PyCharm中进行数据读取代码编写：</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">from</span> ddt <span class="keyword">import</span> ddt,data,unpack</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> potest10_26_01.csvread2 <span class="keyword">import</span> read</span><br><span class="line"></span><br><span class="line"><span class="meta">@ddt</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">duanyan</span>(unittest.TestCase):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUp</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver=webdriver.Chrome()</span><br><span class="line">        self.driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tearDown</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.quit()</span><br><span class="line"><span class="meta">    @data(<span class="params">*read(<span class="params"></span>)</span>)</span></span><br><span class="line"><span class="meta">    @unpack</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_denglu</span>(<span class="params">self,sfz,dy</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.driver.get(<span class="string">&quot;http://192.168.5.7:12906/suthr&quot;</span>)</span><br><span class="line">            self.driver.find_element_by_id(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&#x27;hrteacher&#x27;</span>)</span><br><span class="line">            self.driver.find_element_by_id(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">            self.driver.find_element_by_id(<span class="string">&quot;password&quot;</span>).submit()</span><br><span class="line">            self.driver.find_element_by_link_text(<span class="string">&quot;人资工作台&quot;</span>).click()</span><br><span class="line">            bz1 = self.driver.find_element_by_xpath(<span class="string">&#x27;/html/body/div[4]/div[1]/div/ul/li[5]/a/span[1]&#x27;</span>)</span><br><span class="line">            bz2 = self.driver.find_element_by_xpath(<span class="string">&#x27;/html/body/div[4]/div[1]/div/ul/li[5]/ul/li[1]/a/span[1]&#x27;</span>)</span><br><span class="line">            ActionChains(self.driver).move_to_element(bz1).perform()</span><br><span class="line">            time.sleep(<span class="number">0.5</span>)</span><br><span class="line">            ActionChains(self.driver).click(bz2).perform()</span><br><span class="line">            self.driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;pageContent&quot;]/div[2]/div[2]/div/div/div[1]/div/div/button&#x27;</span>).click()</span><br><span class="line">            self.driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;idCard&quot;]&#x27;</span>).send_keys(sfz)</span><br><span class="line">            self.driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;pageContent&quot;]/div[3]/div/div[1]/button&#x27;</span>).click()</span><br><span class="line">            sfze = self.driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;idCard-error&quot;]&#x27;</span>).text</span><br><span class="line">            self.assertEqual(sfze,dy)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            self.driver.execute_script(<span class="string">&quot;window.scrollTo(0,0)&quot;</span>)</span><br><span class="line">            time.sleep(<span class="number">2</span>)</span><br><span class="line">            <span class="comment"># 方法 一</span></span><br><span class="line">            <span class="comment"># self.driver.get_screenshot_as_file(&quot;./123/%s123_%s.png&quot;%(time.strftime(&#x27;%Y-%m-%d-%H-%M-%S&#x27;),&#x27;asdfasdfasdf&#x27;))</span></span><br><span class="line">            <span class="comment"># 方法 二</span></span><br><span class="line">            cutime = time.strftime(<span class="string">&quot;%Y-%m-%d-%H-%M-%S&quot;</span>)</span><br><span class="line">            currenpath = os.path.dirname(__file__)</span><br><span class="line">            path = currenpath+<span class="string">&quot;/456/&quot;</span>+cutime+<span class="string">&#x27;.png&#x27;</span></span><br><span class="line">            self.driver.get_screenshot_as_file(path)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            self.driver.quit()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这两种方法都不能自己创建文件夹，需要自己自行创建</p>
</blockquote>
<h1 id="discover方法"><a href="#discover方法" class="headerlink" title="discover方法"></a>discover方法</h1><p>使用unittest进行测试的话，如果是需要实现上百个测试用例，把它们全部写在一个test.py文件中，文件会越来越臃肿，后期维护页麻烦。此时可以将这些用例按照测试功能进行拆分，分散到不同的测试文件中。这时候我们可以通过discover方法来执行所有的测试用例。</p>
<p>discover使用格式：discover(start_dir,pattern&#x3D;’test*.py’)</p>
<p>找到指定目录下所有测试模块，并可递归查到子目录下的测试模块，只有匹配到文件名才能被加载。如果启动的不是顶层目录，那么顶层目录必须单独指定。</p>
<p>start_dir：要测试的模块名或测试用例目录</p>
<p>pattern&#x3D;’test*.py’：表示用例文件名的匹配原则。此处匹配文件名以“test”开头的“.py”类型的文件，星号“*”表示任意多个字符</p>
<p><img src="/image-20221026205806485.png" alt="image-20221026205806485"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"></span><br><span class="line">testdir = <span class="string">&quot;./discover&quot;</span></span><br><span class="line"></span><br><span class="line">discover=unittest.defaultTestLoader.discover(testdir,pattern=<span class="string">&quot;test*.py&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    unittest.TextTestRunner().run(discover)</span><br></pre></td></tr></table></figure>

<h1 id="PageObject模式"><a href="#PageObject模式" class="headerlink" title="PageObject模式"></a>PageObject模式</h1><h2 id="PO简介"><a href="#PO简介" class="headerlink" title="PO简介"></a>PO简介</h2><p>Page Object是Selenium自动化测试项目开发实践的最佳设计模式之一，主要是将每一个页面设计为一个Class，其中包含页面中需要测试的元素，这样在Selenium测试页面中可以通过调用页面类来获取页面元素，这样巧妙的避免了当页面元素id或者位置变化时，需要改测试页面代码的情况。 </p>
<p>当页面元素id变化时，只需要更改测试页Class中页面的属性即可。 获取页面中元素的属性可以通过id，class或者XPath获取，在id唯一的情况下，可以使用id获取页面元素，否则可以使用XPath定位页面元素。</p>
<h2 id="PO原理"><a href="#PO原理" class="headerlink" title="PO原理"></a>PO原理</h2><p>PageObject原理：将页面元素定位和对元素的操作行为封装成一个page类，实现对页面对象和测试用例的分离。<br>一条测试用例可能需要多个步骤操作元素，将每个步骤单独的封装成一个方法，在执行测试用例的时候调用封装好的操作。</p>
<h2 id="PO模式的作用"><a href="#PO模式的作用" class="headerlink" title="PO模式的作用"></a>PO模式的作用</h2><p>PageObject模式的优点：</p>
<p>（1）当某一个页面的元素发生变化，只需要修改该页面对象中的代码即可，不需要重复不断的修改测试用例。<br>（2）提高代码重用性，结构更加清晰，维护代码更容易。<br>（3）测试用例发生变化时，只需要修改少数页面对象即可。</p>
<p><code>案例：通过下面的案例步骤在Pycharm中进行代码编写 案例步骤： 1、进入人力资源综合服务系统登录页面； 2、输入用户名和密码； 3、点击登录按钮。 在PyCharm中项目目录如下：</code></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221027154049469.png" alt="image-20221027154049469" title="">
                </div>
                <div class="image-caption">image-20221027154049469</div>
            </figure>

<p><strong>(注：下划线的作用)</strong></p>
<p><strong>来自</strong>：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/36173202">Python中下划线的5种含义 - 知乎 (zhihu.com)</a></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="v2-cbc5c6037101c7d33cf0acd9f00a8cfa_r.jpg" alt="img" title="">
                </div>
                <div class="image-caption">img</div>
            </figure>

<p><strong>(注：*号的作用)</strong></p>
<p>来自：<a target="_blank" rel="noopener" href="https://www.php.cn/python-tutorials-474944.html">Python3中* 和 ** 运算符的用法是什么-Python教程-PHP中文网</a></p>
<p><strong>BasePage.py</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="comment"># 封装好的基础页面，所有页面都要继承</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Page</span>():</span><br><span class="line">    <span class="comment"># 初始化数据</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,driver</span>):</span><br><span class="line">        self.driver = driver</span><br><span class="line">        self.base_url = <span class="string">&quot;http://192.168.5.7:12906&quot;</span></span><br><span class="line">    <span class="comment"># 写好对地址的一些中间操作</span></span><br><span class="line">    <span class="comment"># 这里的作用就是： 后续继续添加页面直接在相应页面添加相应的后面的url就可以了</span></span><br><span class="line">    <span class="comment"># 打开不同的页面，并对页面url进行断言</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_open</span>(<span class="params">self,url</span>):</span><br><span class="line">        url_ = self.base_url+url</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;This url is &quot;</span> + url)</span><br><span class="line">        self.driver.maximize_window()</span><br><span class="line">        self.driver.get(url_)</span><br><span class="line">        sleep(<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">assert</span> self.driver.current_url != url_ , <span class="string">&quot;did not lan on %s&quot;</span>%url_</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">open</span>(<span class="params">self</span>):</span><br><span class="line">        self._<span class="built_in">open</span>(self.url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_element</span>(<span class="params">self,*loc</span>):</span><br><span class="line">        <span class="keyword">return</span> self.driver.find_element(*loc)</span><br><span class="line">    <span class="comment"># 封装元素定位的方法</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>LoginPage.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> page.BasePage <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LoginPage</span>(<span class="title class_ inherited__">Page</span>):</span><br><span class="line">    <span class="comment"># 在这里封装好 loginpage 需要用到的地址和定位</span></span><br><span class="line">    url = <span class="string">&#x27;/suthr/logon&#x27;</span></span><br><span class="line">    username_loc = (By.NAME,<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    password_loc = (By.NAME,<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">    submit_loc = (By.ID,<span class="string">&#x27;loginBtn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 在这边封装好定位需要用到的方法</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_username</span>(<span class="params">self,username</span>):</span><br><span class="line">        self.find_element(*self.username_loc).clear()</span><br><span class="line">        self.find_element(*self.username_loc).send_keys(username)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_password</span>(<span class="params">self,password</span>):</span><br><span class="line">        self.find_element(*self.password_loc).clear()</span><br><span class="line">        self.find_element(*self.password_loc).send_keys(password)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_submit</span>(<span class="params">self</span>):</span><br><span class="line">        self.find_element(*self.submit_loc).click()</span><br><span class="line">    <span class="comment"># 在这边实例化整个对象，并封装成一个方法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_login</span>(<span class="params">driver,username,password</span>):</span><br><span class="line">    login_page=LoginPage(driver)</span><br><span class="line">    login_page.<span class="built_in">open</span>()</span><br><span class="line">    login_page.type_username(username)</span><br><span class="line">    login_page.type_password(password)</span><br><span class="line">    login_page.type_submit()</span><br></pre></td></tr></table></figure>

<p>test_login.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span>  webdriver</span><br><span class="line"><span class="keyword">from</span> page.LoginPage <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">user_login(driver,<span class="string">&#x27;hrteacher&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>



<h1 id="最后题目"><a href="#最后题目" class="headerlink" title="最后题目"></a>最后题目</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221027212316786.png" alt="image-20221027212316786" title="">
                </div>
                <div class="image-caption">image-20221027212316786</div>
            </figure>



<h2 id="driver-py"><a href="#driver-py" class="headerlink" title="driver.py"></a>driver.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">browser</span>():</span><br><span class="line">    driver=webdriver.Chrome()</span><br><span class="line">    <span class="comment">#打开谷歌浏览器</span></span><br><span class="line">    <span class="keyword">return</span> driver</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="function-py"><a href="#function-py" class="headerlink" title="function.py"></a>function.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> smtplib</span><br><span class="line"><span class="keyword">from</span> email.mime.text <span class="keyword">import</span> MIMEText</span><br><span class="line"><span class="keyword">from</span> email.header <span class="keyword">import</span> Header</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="comment">#截图方法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inser_img</span>(<span class="params">driver,filename</span>):</span><br><span class="line">    <span class="comment">#获取当前模块所在路径</span></span><br><span class="line">    func_path=os.path.dirname(__file__)</span><br><span class="line">    <span class="comment">#获取test_case目录</span></span><br><span class="line">    base_dir=os.path.dirname(func_path)</span><br><span class="line">    <span class="comment">#将路径转化为字符串</span></span><br><span class="line">    base_dir=<span class="built_in">str</span>(base_dir)</span><br><span class="line">    <span class="comment">#对路径的字符串进行替换</span></span><br><span class="line">    base_dir=base_dir.replace(<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="comment">#获取项目文件的根目录路径</span></span><br><span class="line">    base=base_dir.split(<span class="string">&#x27;/Website&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="comment">#指定截图存放路径</span></span><br><span class="line">    filepath=base+<span class="string">&#x27;/Website/test_report/screenshot/&#x27;</span>+filename</span><br><span class="line">    driver.get_screenshot_as_file(filepath)</span><br><span class="line"></span><br><span class="line"><span class="comment">#查找最新的测试报告</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">latest_report</span>(<span class="params">report_dir</span>):</span><br><span class="line">    lists = os.listdir(report_dir)</span><br><span class="line">    lists.sort(key=<span class="keyword">lambda</span> fn: os.path.getatime(report_dir + <span class="string">&#x27;\\&#x27;</span> + fn))</span><br><span class="line">    file = os.path.join(report_dir, lists[-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> file</span><br><span class="line"></span><br><span class="line"><span class="comment">#将测试报告发送到邮件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_mail</span>(<span class="params">latest_report</span>):</span><br><span class="line">    <span class="comment">#这里所有的参数使用的是163邮箱，如果使用别的邮箱需要自己配置参数</span></span><br><span class="line">    f=<span class="built_in">open</span>(latest_report,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">    mail_content=f.read()</span><br><span class="line">    f.close()</span><br><span class="line">    smtpserver = <span class="string">&#x27;smtp.163.com&#x27;</span></span><br><span class="line">    user = <span class="string">&#x27;XXX@163.com&#x27;</span>                <span class="comment">#填入自己的邮箱账号</span></span><br><span class="line">    password = <span class="string">&#x27;UCSLGPTXXXMFAX&#x27;</span>      <span class="comment">#填入自己的授权码，注意非邮件密码</span></span><br><span class="line"></span><br><span class="line">    sender = <span class="string">&#x27;XXX@163.com&#x27;</span>    <span class="comment">#填入发送邮箱的账号</span></span><br><span class="line">    receives = <span class="string">&#x27;XXX@qq.com&#x27;</span>  <span class="comment">#填入接收邮箱的账号</span></span><br><span class="line"></span><br><span class="line">    subject = <span class="string">&#x27;Selenium自动化测试报告&#x27;</span></span><br><span class="line"></span><br><span class="line">    msg = MIMEText(mail_content, <span class="string">&#x27;html&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    msg[<span class="string">&#x27;Subject&#x27;</span>] = Header(subject, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    msg[<span class="string">&#x27;From&#x27;</span>] = sender</span><br><span class="line">    msg[<span class="string">&#x27;To&#x27;</span>] = receives</span><br><span class="line"></span><br><span class="line">    smtp = smtplib.SMTP_SSL(smtpserver, <span class="number">465</span>)</span><br><span class="line">    smtp.helo(smtpserver)</span><br><span class="line">    smtp.ehlo(smtpserver)</span><br><span class="line">    smtp.login(user, password)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start send email...&quot;</span>)</span><br><span class="line">    smtp.sendmail(sender, receives, msg.as_string())</span><br><span class="line">    smtp.quit()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Send email end!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#读取csv文件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_csv_file</span>(<span class="params">line</span>):</span><br><span class="line">    <span class="comment"># 文件路径需要自己修改成自己的文件路径</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;C:\Users\蒋英羽\Desktop\任务11.4：Web端—系统管理员 - 副本 (2)\任务实训指导书答案及源码\基于python\源码\Website\test_data\ccs.csv&quot;</span>,encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        reader=csv.reader(file)</span><br><span class="line">        <span class="keyword">for</span> index,row <span class="keyword">in</span> <span class="built_in">enumerate</span>(reader,<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> index==line:</span><br><span class="line">                <span class="keyword">return</span> row</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    data=get_csv_file(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> data:</span><br><span class="line">        <span class="built_in">print</span>(row)</span><br></pre></td></tr></table></figure>

<h2 id="myunit-py"><a href="#myunit-py" class="headerlink" title="myunit.py"></a>myunit.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">from</span> driver.driver <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StartEnd</span>(unittest.TestCase):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUp</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver=browser()</span><br><span class="line">        self.driver.implicitly_wait(<span class="number">10</span>)</span><br><span class="line">        self.driver.maximize_window()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tearDown</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.quit()</span><br></pre></td></tr></table></figure>

<h2 id="AddPage-py"><a href="#AddPage-py" class="headerlink" title="AddPage.py"></a>AddPage.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> Website.test_case.page_object.BasePage <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserAdd</span>(<span class="title class_ inherited__">Page</span>):</span><br><span class="line">    url=<span class="string">&#x27;/&#x27;</span></span><br><span class="line">    Rzgzt_loc=(By.LINK_TEXT,<span class="string">&#x27;人资工作台&#x27;</span>)        <span class="comment">#定位人资工作台按钮</span></span><br><span class="line">    Mhhtgl_loc=(By.LINK_TEXT,<span class="string">&#x27;门户后台管理&#x27;</span>)         <span class="comment">#定位门户后台管理按钮</span></span><br><span class="line">    Yqljgl_loc=(By.XPATH,<span class="string">&#x27;/html/body/div[4]/div[1]/div/ul/li[16]/ul/li[4]/a&#x27;</span>)         <span class="comment">#定位友情链接管理按钮</span></span><br><span class="line">    Tjlj_loc=(By.XPATH,<span class="string">&#x27;//*[@id=&quot;searchForm&quot;]/div/button[2]&#x27;</span>)  <span class="comment">#定位添加链接按钮</span></span><br><span class="line">    Ljmc_loc=(By.ID,<span class="string">&#x27;title&#x27;</span>)  <span class="comment">#定位链接名称输入框</span></span><br><span class="line">    Ljdz_loc=(By.ID,<span class="string">&#x27;url&#x27;</span>)  <span class="comment">#定位链接地址输入框</span></span><br><span class="line">    Bcan_loc=(By.XPATH,<span class="string">&#x27;//*[@id=&quot;ajax-modal&quot;]/div[3]/button[1]&#x27;</span>)            <span class="comment">#定位保存按钮</span></span><br><span class="line">    Tsxx_loc=(By.ID,<span class="string">&#x27;title-error&#x27;</span>)             <span class="comment">#定位连接名称提示消息</span></span><br><span class="line">    Tsxxdz_loc=(By.ID,<span class="string">&#x27;url-error&#x27;</span>)             <span class="comment">#定位连接地址提示消息</span></span><br><span class="line">    Tstc_loc=(By.CLASS_NAME,<span class="string">&#x27;bootbox-body&#x27;</span>)             <span class="comment">#定位弹窗提示文字信息</span></span><br><span class="line">    Tjcg_loc=(By.XPATH,<span class="string">&#x27;//*[@id=&quot;pageContent&quot;]/div[2]/div/div/div/div[2]/table/tbody/tr/td[2]&#x27;</span>)            <span class="comment">#添加成功文本</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_Rzgzt</span>(<span class="params">self</span>):</span><br><span class="line">        self.find_element(*self.Rzgzt_loc).click()</span><br><span class="line">    <span class="comment">#点击人资工作台按钮</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_Mhhtgl</span>(<span class="params">self</span>):</span><br><span class="line">        self.find_element(*self.Mhhtgl_loc).click()</span><br><span class="line">    <span class="comment">#点击门户后台管理按钮</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_Yqljgl</span>(<span class="params">self</span>):</span><br><span class="line">        self.find_element(*self.Yqljgl_loc).click()</span><br><span class="line">    <span class="comment">#点击友情链接管理按钮</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_Tjlj</span>(<span class="params">self</span>):</span><br><span class="line">        self.find_element(*self.Tjlj_loc).click()</span><br><span class="line">    <span class="comment">#点击添加链接按钮</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_Ljmc</span>(<span class="params">self,Name</span>):</span><br><span class="line">        self.find_element(*self.Ljmc_loc).clear()</span><br><span class="line">        self.find_element(*self.Ljmc_loc).send_keys(Name)</span><br><span class="line">    <span class="comment">#输入链接名称</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_Ljdz</span>(<span class="params">self,dizhi</span>):</span><br><span class="line">        self.find_element(*self.Ljdz_loc).clear()</span><br><span class="line">        self.find_element(*self.Ljdz_loc).send_keys(dizhi)</span><br><span class="line">    <span class="comment">#输入链接地址</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_Bcan</span>(<span class="params">self</span>):</span><br><span class="line">        self.find_element(*self.Bcan_loc).click()</span><br><span class="line">    <span class="comment"># 点击保存按钮</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_Tsxx</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.find_element(*self.Tsxx_loc).text</span><br><span class="line">    <span class="comment"># 获取连接名称提示信息</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_Tsxxdz</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.find_element(*self.Tsxxdz_loc).text</span><br><span class="line">    <span class="comment"># 获取连接地址提示信息</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_Tstc</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.find_element(*self.Tstc_loc).get_attribute(<span class="string">&quot;innerHTML&quot;</span>)</span><br><span class="line">    <span class="comment"># 读取弹窗文字信息</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_tjcg</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.find_element(*self.Tjcg_loc).text</span><br><span class="line">    <span class="comment"># 获取添加成功文本</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_gd</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.driver.execute_script(<span class="string">&#x27;window.scrollBy(0,1000)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_user_add</span>(<span class="params">driver,Name,dizhi</span>):</span><br><span class="line">    add_page=UserAdd(driver)</span><br><span class="line">    add_page.type_Rzgzt()</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line">    add_page.type_gd()</span><br><span class="line">    add_page.type_Mhhtgl()</span><br><span class="line">    sleep(<span class="number">3</span>)</span><br><span class="line">    add_page.type_Yqljgl()</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line">    add_page.type_Tjlj()</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line">    add_page.type_Ljmc(Name)</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line">    add_page.type_Ljdz(dizhi)</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line">    add_page.type_Bcan()</span><br><span class="line">    <span class="comment">#封装添加功能</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="BasePage-py"><a href="#BasePage-py" class="headerlink" title="BasePage.py"></a>BasePage.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Page</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;基础类，用于所以页面对象类继承&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, driver</span>):</span><br><span class="line">        self.driver = driver</span><br><span class="line">        self.base_url = <span class="string">&#x27;http://192.168.16.156/suthr/logon&#x27;</span></span><br><span class="line">        self.timeout = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_open</span>(<span class="params">self, url</span>):</span><br><span class="line">        url_ = self.base_url + url</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Test page is %s&quot;</span> % url_)</span><br><span class="line">        self.driver.maximize_window()</span><br><span class="line">        self.driver.get(url_)</span><br><span class="line">        sleep(<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">assert</span> self.driver.current_url == url_, <span class="string">&#x27;Did not land on %s&#x27;</span> % url_</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">open</span>(<span class="params">self</span>):</span><br><span class="line">        self._<span class="built_in">open</span>(self.url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_element</span>(<span class="params">self, *loc</span>):</span><br><span class="line">        <span class="keyword">return</span> self.driver.find_element(*loc)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="LoginPage-py"><a href="#LoginPage-py" class="headerlink" title="LoginPage.py"></a>LoginPage.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Website.test_case.page_object.BasePage <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span>  selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LoginPage</span>(<span class="title class_ inherited__">Page</span>):</span><br><span class="line">    url=<span class="string">&#x27;/&#x27;</span></span><br><span class="line"></span><br><span class="line">    username_loc=(By.NAME,<span class="string">&#x27;username&#x27;</span>)       <span class="comment">#定位用户名输入框</span></span><br><span class="line">    password_loc=(By.NAME,<span class="string">&#x27;password&#x27;</span>)       <span class="comment">#定位密码输入框</span></span><br><span class="line">    submit_loc=(By.ID,<span class="string">&#x27;loginBtn&#x27;</span>)       <span class="comment">#定位登录按钮</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_username</span>(<span class="params">self,username</span>):</span><br><span class="line">        self.find_element(*self.username_loc).clear()</span><br><span class="line">        self.find_element(*self.username_loc).send_keys(username)</span><br><span class="line">    <span class="comment">#输入用户名</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_password</span>(<span class="params">self,password</span>):</span><br><span class="line">        self.find_element(*self.password_loc).clear()</span><br><span class="line">        self.find_element(*self.password_loc).send_keys(password)</span><br><span class="line">    <span class="comment"># 输入密码</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">type_submit</span>(<span class="params">self</span>):</span><br><span class="line">        self.find_element(*self.submit_loc).click()</span><br><span class="line">    <span class="comment">#点击登录按钮</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_user_login</span>(<span class="params">driver,username,password</span>):</span><br><span class="line">    login_page=LoginPage(driver)</span><br><span class="line">    login_page.<span class="built_in">open</span>()</span><br><span class="line">    login_page.type_username(username)</span><br><span class="line">    login_page.type_password(password)</span><br><span class="line">    login_page.type_submit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#封装登录功能</span></span><br></pre></td></tr></table></figure>

<h2 id="test-add-py"><a href="#test-add-py" class="headerlink" title="test_add.py"></a>test_add.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">from</span> Website.test_case.model <span class="keyword">import</span> function,myunit</span><br><span class="line"><span class="keyword">from</span> Website.test_case.page_object.LoginPage <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Website.test_case.page_object.AddPage <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> ddt</span><br><span class="line"></span><br><span class="line"><span class="meta">@ddt.ddt</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LoginTest</span>(myunit.StartEnd):</span><br><span class="line">  <span class="comment"># @unittest.skip(&#x27;skip this case&#x27;)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test01_add_success</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;操作成功&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;test case is start run...&quot;</span>)</span><br><span class="line">        test_date = function.get_csv_file(<span class="number">2</span>)</span><br><span class="line">        <span class="comment">#创建参数接收测试数据</span></span><br><span class="line">        test_user_login(self.driver,<span class="string">&#x27;hrteacher&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">        <span class="comment">#登录</span></span><br><span class="line">        test_user_add(self.driver,test_date[<span class="number">0</span>],test_date[<span class="number">1</span>])</span><br><span class="line">        <span class="comment">#输入测试数据</span></span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        function.inser_img(self.driver,<span class="string">&quot;test01_add_null.png&quot;</span>)</span><br><span class="line">        <span class="comment"># 截屏</span></span><br><span class="line">        po = UserAdd(self.driver)</span><br><span class="line">        <span class="comment"># 设置参数接收数据</span></span><br><span class="line">        self.assertIn(test_date[<span class="number">2</span>], po.type_tjcg())</span><br><span class="line">        <span class="comment"># 断言对比测试用例是否正确</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;test case is successful test end!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test02_add_null</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;连接名称为空&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;test case is start run...&quot;</span>)</span><br><span class="line">        test_date = function.get_csv_file(<span class="number">3</span>)</span><br><span class="line">        <span class="comment">#创建参数接收测试数据</span></span><br><span class="line">        test_user_login(self.driver,<span class="string">&#x27;hrteacher&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">        <span class="comment">#登录</span></span><br><span class="line">        test_user_add(self.driver,test_date[<span class="number">0</span>],test_date[<span class="number">1</span>])</span><br><span class="line">        <span class="comment">#输入测试数据</span></span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        function.inser_img(self.driver,<span class="string">&quot;test01_add_null.png&quot;</span>)</span><br><span class="line">        <span class="comment"># 截屏</span></span><br><span class="line">        po = UserAdd(self.driver)</span><br><span class="line">        <span class="comment"># 设置参数接收数据</span></span><br><span class="line">        self.assertIn(test_date[<span class="number">2</span>], po.type_Tsxx())</span><br><span class="line">        <span class="comment"># 断言对比测试用例是否正确</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;test case is successful test end!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test03_add_null</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;连接地址为空&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;test case is start run...&quot;</span>)</span><br><span class="line">        test_date = function.get_csv_file(<span class="number">4</span>)</span><br><span class="line">        <span class="comment">#创建参数接收测试数据</span></span><br><span class="line">        test_user_login(self.driver,<span class="string">&#x27;hrteacher&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">        <span class="comment">#登录</span></span><br><span class="line">        test_user_add(self.driver,test_date[<span class="number">0</span>],test_date[<span class="number">1</span>])</span><br><span class="line">        <span class="comment">#输入测试数据</span></span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        function.inser_img(self.driver,<span class="string">&quot;test01_add_null.png&quot;</span>)</span><br><span class="line">        <span class="comment"># 截屏</span></span><br><span class="line">        po = UserAdd(self.driver)</span><br><span class="line">        <span class="comment"># 设置参数接收数据</span></span><br><span class="line">        self.assertIn(test_date[<span class="number">2</span>], po.type_Tsxxdz())</span><br><span class="line">        <span class="comment"># 断言对比测试用例是否正确</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;test case is successful test end!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test04_add_repeat</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;连接名称重复&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;test case is start run...&quot;</span>)</span><br><span class="line">        test_date = function.get_csv_file(<span class="number">5</span>)</span><br><span class="line">        <span class="comment">#创建参数接收测试数据</span></span><br><span class="line">        test_user_login(self.driver,<span class="string">&#x27;hrteacher&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">        <span class="comment">#登录</span></span><br><span class="line">        test_user_add(self.driver,test_date[<span class="number">0</span>],test_date[<span class="number">1</span>])</span><br><span class="line">        <span class="comment">#输入测试数据</span></span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        function.inser_img(self.driver,<span class="string">&quot;test01_add_null.png&quot;</span>)</span><br><span class="line">        <span class="comment"># 截屏</span></span><br><span class="line">        po = UserAdd(self.driver)</span><br><span class="line">        <span class="comment"># 设置参数接收数据</span></span><br><span class="line">        self.assertIn(test_date[<span class="number">2</span>], po.type_Tstc())</span><br><span class="line">        <span class="comment"># 断言对比测试用例是否正确</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;test case is successful test end!&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="ccs-csv"><a href="#ccs-csv" class="headerlink" title="ccs.csv"></a>ccs.csv</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">测试数据</span><br><span class="line">测试连接,www.ceshi.com,测试连接</span><br><span class="line">,www.ceshi.com,必须填写</span><br><span class="line">测试链接,,必须填写</span><br><span class="line">测试连接,www.ceshi.com,链接名称已经存在，请重新填写！</span><br></pre></td></tr></table></figure>

<h2 id="runtest-py"><a href="#runtest-py" class="headerlink" title="runtest.py"></a>runtest.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">from</span> Website.test_case.model.function <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> HTMLTestRunner <span class="keyword">import</span> HTMLTestRunner</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">report_dir=<span class="string">&#x27;./test_report&#x27;</span></span><br><span class="line">test_dir=<span class="string">&#x27;./test_case&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;start run test case&quot;</span>)</span><br><span class="line">discover=unittest.defaultTestLoader.discover(test_dir,pattern=<span class="string">&quot;test_add.py&quot;</span>)</span><br><span class="line"></span><br><span class="line">now=time.strftime(<span class="string">&quot;%Y-%m-%d %H_%M_%S&quot;</span>)</span><br><span class="line">report_name=report_dir+<span class="string">&#x27;/&#x27;</span>+now+<span class="string">&#x27;result.html&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;start write report..&quot;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(report_name,<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    runner=HTMLTestRunner(stream=f,title=<span class="string">&quot;Test Report&quot;</span> ,description=<span class="string">&quot;localhost login test&quot;</span>)</span><br><span class="line">    runner.run(discover)</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;find latest report&quot;</span>)</span><br><span class="line">latest_report=latest_report(report_dir)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;send email report..&quot;</span>)</span><br><span class="line">send_mail(latest_report)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Test end&quot;</span>)</span><br></pre></td></tr></table></figure>





<h2 id="自己跟着敲的"><a href="#自己跟着敲的" class="headerlink" title="自己跟着敲的"></a>自己跟着敲的</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221028102848155.png" alt="image-20221028102848155" title="">
                </div>
                <div class="image-caption">image-20221028102848155</div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20221028102955027.png" alt="image-20221028102955027" title="">
                </div>
                <div class="image-caption">image-20221028102955027</div>
            </figure>

<ul>
<li><p>os出来的路径就是”&#x2F;“</p>
</li>
<li><p>无需字符串转化</p>
</li>
<li><p>也不用<code>base_dir=base_dir.replace(&#39;\\&#39;,&#39;/&#39;)</code>转换</p>
<p><strong><code>for index,row in enumerate(reader,1):</code>是什么意思</strong></p>
<p><img src="/image-20221028103723325.png" alt="image-20221028103723325"></p>
</li>
</ul>
<p><strong>总而言之enumerate就是<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%9E%9A%E4%B8%BE&spm=1001.2101.3001.7020">枚举</a>的意思，把元素一个个列举出来，第一个是什么，第二个是什么，所以他返回的是元素以及对应的索引。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">line = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">enumerate</span>(line):</span><br><span class="line">    <span class="built_in">print</span>(i,j)</span><br><span class="line"><span class="comment">#以下是输出结果</span></span><br><span class="line"><span class="number">0</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="number">3</span> <span class="number">4</span></span><br><span class="line"><span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="number">5</span> <span class="number">6</span></span><br><span class="line"><span class="number">6</span> <span class="number">7</span></span><br><span class="line"><span class="number">7</span> <span class="number">8</span></span><br><span class="line"><span class="number">8</span> <span class="number">9</span></span><br><span class="line"><span class="comment">#eg2:</span></span><br><span class="line">line = [<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;d&quot;</span>,<span class="string">&quot;e&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">enumerate</span>(line):</span><br><span class="line">    <span class="built_in">print</span>(i,j)</span><br><span class="line"><span class="comment">#output:</span></span><br><span class="line"><span class="number">0</span> a</span><br><span class="line"><span class="number">1</span> b</span><br><span class="line"><span class="number">2</span> c</span><br><span class="line"><span class="number">3</span> d</span><br><span class="line"><span class="number">4</span> e</span><br></pre></td></tr></table></figure>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2022-10-30T04:26:01.916Z" itemprop="dateUpdated">2022-10-30 12:26:01</time>
</span><br>


        
        这里可以写作者留言，标签和 hexo 中所有变量及辅助函数等均可调用，示例：<a href="<%- url_for(page.path).replace(/index\.html$/, '') %>" target="_blank" rel="external"><%- page.permalink.replace(/index\.html$/, '') %></a>
        
    </div>
    
    <footer>
        <a href="http://example.com">
            <img src="/img/avatar.jpg" alt="John Doe">
            John Doe
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" rel="tag">自动化测试</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/" rel="tag">软件测试</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/&title=《自动化测试》 — Hexo&pic=http://example.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/&title=《自动化测试》 — Hexo&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《自动化测试》 — Hexo&url=http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/&via=http://example.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2022/10/19/hexo/%E5%9C%A8HEXO%E4%B8%AD%E6%B7%BB%E5%8A%A0%E6%96%B0%E9%A1%B5%E9%9D%A2/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">在HEXO中添加新页面</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95-jmeter/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">性能测试-jmeter</h4>
      </a>
    </div>
  
</nav>



    




















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license noopener" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>John Doe &copy; 2015 - 2022</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/&title=《自动化测试》 — Hexo&pic=http://example.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/&title=《自动化测试》 — Hexo&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《自动化测试》 — Hexo&url=http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/&via=http://example.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=http://example.com/2022/10/18/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.js?v=1.7.2" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
